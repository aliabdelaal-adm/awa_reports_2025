# دليل استخدام ميزة التصدير 📊

## نظرة عامة
تم إضافة ميزة تصدير شاملة تسمح لمسؤول النظام بتحميل وحفظ جميع التقارير والبيانات المعروضة بصيغات متعددة: PDF، Excel، وPowerPoint.

## 🎯 الهدف من الميزة
تسهيل عملية مشاركة التقارير وحفظها للرجوع إليها أو عرضها في اجتماعات أو إرسالها عبر البريد الإلكتروني.

## 📍 موقع الأزرار
توجد أزرار التصدير في شريط منفصل أسفل شريط التنقل الرئيسي مباشرة، وتتضمن ثلاثة أزرار:

1. **📄 تصدير PDF** (باللون الأحمر)
2. **📊 تصدير Excel** (باللون الأخضر)
3. **📽️ تصدير PowerPoint** (باللون البرتقالي)

## 🔧 كيفية الاستخدام

### 1️⃣ تصدير PDF
**الخطوات:**
1. اضغط على زر "📄 تصدير PDF"
2. انتظر حتى يتم معالجة البيانات (سيظهر نص "⏳ جاري التصدير...")
3. سيتم تحميل ملف PDF تلقائياً باسم `التقرير_الشامل_YYYY-MM-DD.pdf`

**محتويات ملف PDF:**
- صفحة عنوان مع شعار النظام
- الإحصائيات الرئيسية (إجمالي البنود، المنجز، قيد الإجراء، نسبة الإنجاز)
- لقطة من جدول البيانات الرئيسي
- تذييل في كل صفحة يحتوي على معلومات المطور ورقم الصفحة

**متى تستخدمه:**
- عند الحاجة لطباعة التقرير
- لإرسال تقرير رسمي عبر البريد الإلكتروني
- للأرشفة طويلة المدى

### 2️⃣ تصدير Excel
**الخطوات:**
1. اضغط على زر "📊 تصدير Excel"
2. انتظر حتى يتم معالجة البيانات
3. سيتم تحميل ملف Excel تلقائياً باسم `التقرير_الشامل_YYYY-MM-DD.xlsx`

**محتويات ملف Excel (6 أوراق عمل):**

**الورقة 1: الإحصائيات**
- إجمالي البنود
- البنود المنجزة
- قيد الإجراء
- نسبة الإنجاز
- عدد التحديات
- عدد الحلول
- توزيع الأولويات

**الورقة 2: جميع البيانات**
- جدول كامل بجميع البيانات المسجلة في النظام

**الورقة 3: التحديات**
- جدول بجميع التحديات والملاحظات

**الورقة 4: الحلول**
- جدول بجميع الحلول والإجراءات التحسينية

**الورقة 5: التوصيات**
- جدول بجميع التوصيات المقترحة

**الورقة 6: التقارير الشهرية**
- توزيع البنود حسب الأشهر
- إحصائيات شهرية مفصلة

**متى تستخدمه:**
- للتحليل المتقدم باستخدام Excel
- لإنشاء تقارير مخصصة
- لمشاركة البيانات مع فرق أخرى
- لإجراء عمليات حسابية إضافية

### 3️⃣ تصدير PowerPoint
**الخطوات:**
1. اضغط على زر "📽️ تصدير PowerPoint"
2. انتظر حتى يتم إنشاء العرض التقديمي
3. سيتم تحميل ملف PowerPoint تلقائياً باسم `التقرير_الشامل_YYYY-MM-DD.pptx`

**محتويات عرض PowerPoint (5 شرائح):**

**الشريحة 1: شريحة العنوان**
- عنوان النظام
- اسم القسم والإدارة
- شعار بلدية أبوظبي

**الشريحة 2: الإحصائيات الرئيسية**
- جدول بالمؤشرات الرئيسية للأداء

**الشريحة 3: توزيع الأولويات**
- جدول يوضح توزيع البنود حسب الأولوية

**الشريحة 4: التقدم الشهري**
- جدول مفصل بالتقدم الشهري لكل شهر

**الشريحة 5: شريحة الختام**
- شكر وتقدير
- معلومات التواصل

**متى تستخدمه:**
- لتقديم عرض في الاجتماعات
- للعرض على الشاشة الكبيرة
- لمشاركة ملخص مرئي سريع
- للعروض التقديمية الرسمية

## 🔐 الأمان والخصوصية
- جميع عمليات التصدير تتم من جانب المتصفح (Client-side)
- لا يتم إرسال أي بيانات إلى خوادم خارجية
- الملفات المصدرة تبقى على جهاز المستخدم فقط

## 📚 المكتبات المستخدمة

### 1. jsPDF v2.5.1
- **الوظيفة:** إنشاء ملفات PDF
- **المصدر:** https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js
- **الترخيص:** MIT License

### 2. html2canvas v1.4.1
- **الوظيفة:** التقاط لقطات من عناصر HTML
- **المصدر:** https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js
- **الترخيص:** MIT License

### 3. SheetJS (xlsx) v0.18.5
- **الوظيفة:** إنشاء ملفات Excel
- **المصدر:** https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js
- **الترخيص:** Apache-2.0 License

### 4. PptxGenJS v3.12.0
- **الوظيفة:** إنشاء عروض PowerPoint
- **المصدر:** https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.12.0/pptxgen.bundle.js
- **الترخيص:** MIT License

## 🌐 متطلبات التشغيل
- متصفح حديث (Chrome, Firefox, Safari, Edge)
- اتصال بالإنترنت (لتحميل المكتبات من CDN)
- JavaScript مُفعّل في المتصفح

## ⚠️ ملاحظات مهمة
1. **حجم الملفات:** قد تكون ملفات PDF كبيرة الحجم إذا كانت البيانات كثيرة
2. **الأداء:** قد يستغرق التصدير بضع ثوانٍ حسب كمية البيانات
3. **المتصفح:** تأكد من السماح للمتصفح بتحميل الملفات
4. **اللغة العربية:** جميع الملفات المصدرة تدعم اللغة العربية بشكل كامل

## 🐛 حل المشاكل الشائعة

### المشكلة: لا يتم تحميل الملف
**الحل:**
- تأكد من إعدادات المتصفح للسماح بالتحميل
- تحقق من وجود مانع إعلانات (Ad Blocker) قد يمنع التحميل

### المشكلة: رسالة خطأ أثناء التصدير
**الحل:**
- تحقق من اتصالك بالإنترنت
- أعد تحميل الصفحة وحاول مرة أخرى
- امسح ذاكرة التخزين المؤقت للمتصفح

### المشكلة: النص العربي يظهر بشكل خاطئ
**الحل:**
- استخدم متصفح حديث
- تأكد من تحديث المتصفح لآخر إصدار

## 📞 الدعم الفني
للحصول على الدعم أو الإبلاغ عن مشكلة:
- **البريد الإلكتروني:** ali.abdelaal@adm.gov.ae
- **الهاتف:** 581187777
- **المطور:** د. علي عبدالعال

## 🔄 تحديثات مستقبلية محتملة
- [ ] إضافة خيار تخصيص محتوى التصدير
- [ ] دعم تصدير صيغ إضافية (Word, CSV)
- [ ] إضافة قوالب متعددة للعروض التقديمية
- [ ] تصدير مخططات بيانية تفاعلية
- [ ] جدولة تصدير تلقائي دورية
- [ ] إرسال التقارير عبر البريد الإلكتروني مباشرة

---

**تم التطوير بواسطة:** د. علي عبدالعال  
**القسم:** إدارة الصحة العامة - قسم الرقابة والرفق بالحيوان  
**الجهة:** بلدية مدينة أبوظبي  
**التاريخ:** 2025
