<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الخطة التحسينية المستمرة - نظام التفتيش الموحد</title>
    
    <!-- Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.12.0/pptxgen.bundle.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            direction: rtl;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .navigation {
            background: #ecf0f1;
            padding: 15px 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #3498db;
        }
        
        .nav-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .nav-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .nav-button.active {
            background: #27ae60;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .section-header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .table-wrapper {
            overflow-x: auto;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #2c3e50;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 12px 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
        }
        
        .month-row {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%) !important;
            color: white !important;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .month-row td {
            border-color: #27ae60 !important;
        }
        
        .priority-high {
            background-color: #ffebee;
            color: #c62828;
            font-weight: bold;
        }
        
        .priority-medium {
            background-color: #fff8e1;
            color: #f57c00;
            font-weight: bold;
        }
        
        .priority-low {
            background-color: #e8f5e9;
            color: #2e7d32;
            font-weight: bold;
        }
        
        .status-done {
            background-color: #c8e6c9;
            color: #1b5e20;
            font-weight: bold;
        }
        
        .status-pending {
            background-color: #fff9c4;
            color: #f57f17;
            font-weight: bold;
        }
        
        .empty-row {
            background-color: #f5f5f5 !important;
            font-style: italic;
            color: #757575;
        }
        
        .footer {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1em;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            font-size: 1em;
            opacity: 0.9;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .insight-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
            animation: slideIn 0.5s ease;
        }
        
        .insight-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .insight-card p {
            color: #555;
            line-height: 1.6;
        }
        
        .suggestion-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        .suggestion-card h4 {
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }
        
        .month-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .month-header {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .navigation {
                padding: 10px;
            }
            
            .nav-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
            
            .content {
                padding: 15px;
            }
            
            th, td {
                padding: 8px 5px;
                font-size: 0.9em;
            }
        }
        
        /* Sheikh Zayed Splash Screen Styles */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c5f2d 0%, #1a3d1b 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            cursor: pointer;
            animation: fadeIn 0.5s ease-in;
        }
        
        .splash-screen.fade-out {
            animation: fadeOut 0.5s ease-out forwards;
        }
        
        .splash-content-container {
            text-align: center;
            animation: zoomIn 0.8s ease-out;
            max-width: 90%;
        }
        
        .splash-logo {
            max-width: 250px;
            max-height: 250px;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            filter: drop-shadow(0 10px 30px rgba(0,0,0,0.5));
            animation: pulse 2s ease-in-out infinite;
            border: 5px solid #fff;
        }
        
        .splash-video-container {
            margin-top: 20px;
            max-width: 560px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            position: relative;
        }
        
        .splash-video-container iframe {
            width: 100%;
            height: 315px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .video-poster {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 315px;
            background-size: cover;
            background-position: center;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: opacity 0.3s ease;
        }
        
        .video-poster.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .play-button {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .play-button:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 1);
        }
        
        .play-button::after {
            content: '';
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 15px 0 15px 25px;
            border-color: transparent transparent transparent #2c5f2d;
            margin-left: 5px;
        }
        
        .video-error {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 315px;
            background: rgba(44, 95, 45, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            color: white;
            text-align: center;
            padding: 20px;
            z-index: 10;
        }
        
        .video-error p {
            margin: 5px 0;
            font-size: 1.1em;
        }
        
        .retry-button {
            background: rgba(255, 255, 255, 0.95);
            color: #2c5f2d;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .retry-button:hover {
            transform: scale(1.05);
            background: white;
        }
        
        .splash-title {
            color: #fff;
            font-size: 2.2em;
            margin-top: 20px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .splash-subtitle {
            color: #f0f0f0;
            font-size: 1.3em;
            margin-top: 10px;
            font-style: italic;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        
        .splash-hint {
            color: rgba(255,255,255,0.8);
            font-size: 0.9em;
            margin-top: 15px;
            animation: blink 2s ease-in-out infinite;
        }
        
        .splash-unmute-hint {
            color: rgba(255,255,255,0.9);
            font-size: 1em;
            margin-top: 10px;
            background: rgba(44, 95, 45, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        @keyframes zoomIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes blink {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        @media print { 
            .splash-screen { 
                display: none !important; 
            } 
        }
        
        /* Export Buttons Styles */
        .export-section {
            background: #ecf0f1;
            padding: 15px 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #e74c3c;
        }
        
        .export-button {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .export-button:hover {
            background: linear-gradient(135deg, #c0392b 0%, #922b21 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .export-button.excel {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .export-button.excel:hover {
            background: linear-gradient(135deg, #229954 0%, #1e8449 100%);
        }
        
        .export-button.powerpoint {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }
        
        .export-button.powerpoint:hover {
            background: linear-gradient(135deg, #d35400 0%, #ba4a00 100%);
        }
        
        @media (max-width: 768px) {
            .export-section {
                padding: 10px;
            }
            
            .export-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <!-- Sheikh Zayed Splash Screen -->
    <div id="splashScreen" class="splash-screen" onclick="hideSplashScreen(event)">
        <div class="splash-content-container">
            <!-- Sheikh Zayed Image from Wikipedia -->
            <img class="splash-logo" 
                 src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/Zayed_bin_Sultan_Al_Nahyan_in_1976_%28cropped%29.jpg/800px-Zayed_bin_Sultan_Al_Nahyan_in_1976_%28cropped%29.jpg" 
                 alt="الشيخ زايد بن سلطان آل نهيان"
                 onerror="this.src='https://upload.wikimedia.org/wikipedia/commons/4/47/Zayed_bin_Sultan_Al_Nahyan_in_1976.jpg'">
            
            <div class="splash-title">الشيخ زايد بن سلطان آل نهيان</div>
            <div class="splash-subtitle">"واجبنا أن نعمل المستحيل ونعمل الأشياء الغريبة"</div>
            
            <!-- YouTube Video -->
            <div class="splash-video-container">
                <div id="videoPoster" class="video-poster" 
                     style="background-image: url('https://i.ytimg.com/vi/HKP4i6gePWw/maxresdefault.jpg');"
                     onclick="playVideo(event)">
                    <div class="play-button"></div>
                </div>
                <iframe id="splashVideo"
                        src="https://www.youtube.com/embed/HKP4i6gePWw?autoplay=1&mute=1&enablejsapi=1&rel=0" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                        allowfullscreen>
                </iframe>
                <div id="videoError" class="video-error" style="display: none;">
                    <p>⚠️ تعذر تحميل الفيديو</p>
                    <button onclick="retryVideo(event)" class="retry-button">🔄 إعادة المحاولة</button>
                    <p style="margin-top: 10px; font-size: 0.9em;">أو <a href="https://www.youtube.com/watch?v=HKP4i6gePWw" target="_blank" style="color: #fff; text-decoration: underline;">شاهد على يوتيوب</a></p>
                </div>
            </div>
            <div class="splash-unmute-hint">▶️ اضغط زر التشغيل لسماع كلمات الشيخ زايد</div>
            
            <div class="splash-hint">اضغط في أي مكان للمتابعة</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>🏥 الخطة التحسينية المستمرة لنظام التفتيش الموحد</h1>
            <p>إدارة الصحة العامة - قسم الرقابة والرفق بالحيوان - بلدية مدينة أبوظبي</p>
        </div>
        
        <div class="navigation">
            <button class="nav-button" onclick="showSection('statistics')">📈 لوحة التحكم التحليلية</button>
            <button class="nav-button" onclick="showSection('analytics')">📊 التحليلات المتقدمة</button>
            <button class="nav-button" onclick="showSection('monthly')">📅 التقارير الشهرية</button>
            <button class="nav-button" onclick="showSection('challenges')">⚠️ التحديات</button>
            <button class="nav-button" onclick="showSection('solutions')">✅ الحلول والإجراءات</button>
            <button class="nav-button" onclick="showSection('recommendations')">💡 التوصيات</button>
            <button class="nav-button" onclick="showSection('suggestions')">🚀 مقترحات التطوير</button>
            <button class="nav-button active" onclick="showSection('all')">📋 جميع البيانات</button>
        </div>
        
        <!-- Export Section for System Administrator -->
        <div class="export-section">
            <button class="export-button" onclick="exportToPDF()">
                📄 تصدير PDF
            </button>
            <button class="export-button excel" onclick="exportToExcel()">
                📊 تصدير Excel
            </button>
            <button class="export-button powerpoint" onclick="exportToPowerPoint()">
                📽️ تصدير PowerPoint
            </button>
        </div>
        
        <div class="content">
            <!-- Enhanced Statistics Dashboard -->
            <div id="statistics" class="section">
                <div class="section-header">📈 لوحة التحكم التحليلية - الملخص التنفيذي</div>
                
                <!-- Key Performance Indicators -->
                <div class="stats-container" id="statsContainer">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <!-- Charts Section -->
                <div class="analytics-grid">
                    <div class="chart-container">
                        <div class="chart-title">📊 توزيع المهام حسب الحالة</div>
                        <div class="chart-wrapper" id="statusPieChart">
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">⏱️ توزيع المهام حسب الأولوية</div>
                        <div class="chart-wrapper" id="priorityChart">
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">📈 التقدم الشهري في الإنجاز</div>
                    <div class="chart-wrapper" id="progressLineChart">
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">🏢 المواضيع الأكثر تكراراً</div>
                    <div class="chart-wrapper" id="topicsBarChart">
                    </div>
                </div>
            </div>
            
            <!-- Advanced Analytics Section -->
            <div id="analytics" class="section">
                <div class="section-header">📊 التحليلات المتقدمة والرؤى الذكية</div>
                
                <div class="analytics-grid">
                    <div class="insight-card">
                        <h4>📌 نسبة الإنجاز الإجمالية</h4>
                        <p id="completionInsight">يتم حساب التحليلات...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>⚡ المهام ذات الأولوية العالية</h4>
                        <p id="priorityInsight">يتم حساب التحليلات...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>📅 متوسط وقت الإنجاز</h4>
                        <p id="timeInsight">يتم حساب التحليلات...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>🎯 أكثر الجهات المعنية نشاطاً</h4>
                        <p id="authorityInsight">يتم حساب التحليلات...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>📊 توزيع التحديات</h4>
                        <p id="challengeInsight">يتم حساب التحليلات...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>✨ التوصيات الذكية</h4>
                        <p id="smartRecommendation">يتم حساب التحليلات...</p>
                    </div>
                </div>
            </div>
            
            <!-- Monthly Reports Section -->
            <div id="monthly" class="section">
                <div class="section-header">📅 التقارير الشهرية المفصلة</div>
                <div id="monthlyReports">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Suggestions Section -->
            <div id="suggestions" class="section">
                <div class="section-header">🚀 مقترحات التطوير والحلول الإبداعية</div>
                
                <div class="suggestion-card">
                    <h4>🤖 الذكاء الاصطناعي في التفتيش</h4>
                    <p>تطوير نظام ذكاء اصطناعي للتنبؤ بالمخالفات المحتملة بناءً على البيانات التاريخية وأنماط السلوك، مما يساعد في التخطيط الاستباقي وتحسين كفاءة عمليات التفتيش.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>📱 تطبيق موبايل متقدم</h4>
                    <p>تطوير تطبيق موبايل متكامل مع واجهة مستخدم سهلة وبديهية، يدعم العمل دون اتصال بالإنترنت، مع مزامنة تلقائية عند توفر الاتصال، وإشعارات فورية للمفتشين.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>🔗 التكامل مع الأنظمة الخارجية</h4>
                    <p>ربط النظام مع أنظمة الترخيص والرخص التجارية والخرائط الرقمية وأنظمة إدارة الشكاوى، لتوفير رؤية شاملة ومتكاملة عن حالة كل منشأة.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>📊 لوحة تحكم تفاعلية متقدمة</h4>
                    <p>تطوير لوحة تحكم ديناميكية بتحليلات فورية وتقارير مخصصة قابلة للتصدير، مع إمكانية تخصيص المؤشرات حسب احتياجات كل مستخدم أو قسم.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>🎓 نظام تدريب وتطوير المفتشين</h4>
                    <p>إنشاء منصة تعليمية إلكترونية متكاملة لتدريب المفتشين الجدد والحاليين، مع اختبارات تقييمية دورية وشهادات معتمدة، لضمان جودة الأداء المستمرة.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>🔍 نظام تتبع ذكي</h4>
                    <p>تطوير نظام تتبع متقدم يستخدم تقنيات GPS و Geofencing لتحديد موقع المفتشين في الوقت الفعلي وتوزيع المهام بناءً على القرب الجغرافي لتحسين الكفاءة.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>💬 نظام تواصل موحد</h4>
                    <p>إنشاء قنوات تواصل مباشرة بين المفتشين والمشرفين والدعم الفني داخل النظام، مع إمكانية مشاركة الملفات والصور والملاحظات الفورية.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>🏆 نظام تقييم الأداء والحوافز</h4>
                    <p>تطوير نظام آلي لتقييم أداء المفتشين بناءً على معايير موضوعية، مع لوحة شرف وحوافز تشجيعية للمتميزين، مما يعزز التنافس الإيجابي والإنتاجية.</p>
                </div>
            </div>
            
            <!-- All Data Section -->
            <div id="all" class="section active">
                <div class="section-header">📊 جميع بيانات الخطة التحسينية</div>
                <div class="table-wrapper">
<table>
    <tr>
        <th colspan="16">الخطة التحسينية المستمرة لنظام التفتيش الموحد الخاص بإدارة الصحة العامة</th>
    </tr>
    <tr>
        <th>م</th>
        <th>الموضوع</th>
        <th>الاجراء التحسيني</th>
        <th>الجهة المعنية</th>
        <th>تاريخ إدراج الملاحظات</th>
        <th>الأولوية</th>
        <th>تاريخ الإنجاز</th>
        <th>التحديات</th>
        <th>ملاحظات شركة تطوير</th>
        <th>الحالة</th>
        <th colspan="6">معلومات إضافية</th>
    </tr>
    <tr>
        <td>شهر أبريل 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>هام وغير عاجل</td>
    </tr>
    <tr>
        <td>1</td>
        <td>الصلاحيات الممنوحة </td>
        <td> توفير صلاحية التفتيش والاشراف لمشرف التفتيش وذلك لقلة عدد الموظفين في قسم الرقابة والرفق بالحيوان </td>
        <td>شركة تطوير </td>
        <td>1/4/24</td>
        <td>هام وعاجل</td>
        <td>22-04-2024</td>
        <td>عدم توفر صلاحية التفتيش لمشرف التفيش الخاص بقسم الرقابة والرفق بالحيوان </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>غير هام وعاجل</td>
    </tr>
    <tr>
        <td>2</td>
        <td>التقارير </td>
        <td>رسم إجراء آلية استخراج التقرير وتزويد الموظفين المعنين مع الشرح الحضوري لها </td>
        <td>شركة تطوير </td>
        <td>1/4/24</td>
        <td>هام وغير عاجل</td>
        <td>25-04-2024</td>
        <td>عدم القدرة على استخراج التقارير الخاصة بقسم الرقابة والرفق بالحيوان </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>غير هام وغير عاجل</td>
    </tr>
    <tr>
        <td>3</td>
        <td>معايير التفتيش </td>
        <td>التواصل مع الإدارة المعنية في الدائرة وادراج جميع معايير التفتيش الخاصة بقسم الرقابة والرفق بالحيوان </td>
        <td>شركة تطوير </td>
        <td>1/4/24</td>
        <td>هام وعاجل</td>
        <td>26-04-2024</td>
        <td>عدم إدراج معايير التفتيش الخاصة بقسم الرقابة والرفق بالحيوان المحدثة </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر مايو 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>الصلاحيات الممنوحة </td>
        <td>توفير صلاحية في النظام لأحد المعنيين لإدخال جميع بنود التفتيش الخاصة بقسم الرقابة والرفق بالحيوان من دليل المخالفات المعتمدة  </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وعاجل</td>
        <td>22-05-2024</td>
        <td>عدم توفر جميع بنود التفتيش لإختيار البند المناسب عند الرصد </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>توفير صلاحية دخول للنظام بالهوية الرقمية للموظفين الجدد في قسم الرقابة والرفق بالحيوان</td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>نوصي بإنشاء حسابات للمفتشين الجدد</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>2</td>
        <td>النطاقات الممنوحة </td>
        <td>فتح جميع النطاقات على مفتشين قسم الرقابة والرفق بالحيوان وذلك لمهام التفتيش التخصصية </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>لوحظ تحديد النطاقات على مفتشين الرقابة والرفق بالحيوان مما يعرقل في عملية التفتيش وهبوط في مؤشر الأداء </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>فتح النطاق الجغرافي الشامل لإمارة أبوظبي لتوفير الوقت والجهد في تحديد المركز محل التفتيش لعدم الإنتباه لتغيير النطاق أو المركز منذ آخر عملية تفتيش</td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>وجوب اختيار مركز أو نطاق قبل الشروع في عملية التفتيش</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>3</td>
        <td>المشاكل التقنية </td>
        <td>عقد ورشة حضورية وتدريب فردي لكل مفتش وحل المشاكل التقنية </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>توجد مشاكل تقنية في ادراج البيانات في النظام مما يعرقل سير عمل التفتيش </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>تفعيل خيار الرصد المباشر في البرنامج لتسريع وتبسيط اجراءات التفتيش علي موظفي قسم الرقابة والرفق بالحيوان</td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وعاجل</td>
        <td>22-05-2024</td>
        <td> الرصد المباشر غير مفعل في النظام ولا تكتمل اجراءات التفتيش من خلاله</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>السماح للمفتش باستكمال اجراءات الرصد السابق الخاص به </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وعاجل</td>
        <td>22-05-2024</td>
        <td>لايستطيع المفتش متابعة التفتيش الخاص به واستكمال الرصد السابق الذي أجراه عند تاريخ استحقاقه</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>السماح لجميع المفتشين بمتابعة واستكمال الرصد السابق لغيرهم من المفتشين والإطلاع الكامل علي جميع البنود المدرجة في التفتيش </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td></td>
        <td>لايستطيع المفتش متابعة الرصد السابق للمفتشين الآخرين أو الإطلاع علي بنوده مما يعرقل عملية التفتيش أو اضافة بنود جديدة لنفس المحل </td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>توفير صلاحية للمفتش بالتعديل علي المسوده لتوفير الوقت والجهد في اعادة الرصد من البداية</td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>غير هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>تعثر الدخول إلي الرصد والتعديل عليه وهو في وضع المسوده</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>استكمال ادراج بنود جديدة في النظام تمكن مفتشي الرقابة والرفق بالحيوان من توثيق التفتيش خاصة عند عدم رصد أي بنود مخالفة أو كانت المنشأة مغلقة وقت التفتيش</td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>تعثر تسجيل التفتيش المستوفي للشروط أو المغلق وقت التفتيش في النظام </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>تطوير وإضافة لغات جديدة تتوافق مع مختلف الجنسيات من المتعاملين </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>غير هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>لغات الرسائل النصية الصادرة من النظام إلي المتعامل والموظف وقت اكتمال الرصد غير متنوعة أو مناسبة لمختلف الجنسيات وينقصها لغة إنجليزي - أوردو</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>برمجة النظام ليسمح بحفظ بيانات المنشأة عند إضافة أكثر من بند أو مهمة تفتيش لذات المنشأة وقت الرصد في الموقع </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وعاجل</td>
        <td>22-05-2024</td>
        <td>عند إدخال أكثر من مهمة أو بند تفتيش آخر لنفس المنشأة يتطلب النظام بدأ البحث من جديد عن المنشأة مما يتسبب في مضيعة الوقت وارهاق المفتش</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>برمجة أيقونة اشعارات النظام لتكون واضحة ومحددة لكل عملية رصد لتشمل بيانات واضحة عن اسم المنشأة وعنوانها ونص البند من التعليق وتاريخ الرصد أو المتابعة عند الإستحقاق </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>تكدس الإشعارات وصعوبة اختيار الإشعار المناسب لمتابعة عملية الرصد وقت استحقاقها دون الحاجة لفتح اشعار اشعار لمعرفة الإشعار المستحق للمتابعة وتفعيل الألوان الأحمر والأخضر  </td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>الإيعاز للمشرفين في القروب لإضافة جميع مفتشي الرقابة والرفق بالحيوان </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وغير عاجل</td>
        <td>22-05-2024</td>
        <td>عدم تواجد بعض المفتشين الجدد في قروب برنامج الرقابة الموحد للإطلاع علي آخر المستجدات </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>برمجة تصنيف فرعي جديد تحت مسمي سوق المواشي من التصنيف الرئيسي الصحة العامة ويشمل جميع بنود التفتيش المناسبة لأسواق المواشي </td>
        <td>شركة تطوير </td>
        <td>16-05-2024</td>
        <td>هام وعاجل</td>
        <td>22-05-2024</td>
        <td>إضافة بنود تفتيش خاصة بأسواق المواشي وإضافة تصنيف فرعي باسم سوق المواشي يندرج تحت التصنيف الرئيسي الصحة العامة</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>فك الإرتباط بين مختلف التصنيفات والبنود التابعة لها والسماح بالتدقيق فقط علي بنود الإختصاص المناسبة لطبيعة نشاط كل منشأة ( تدقيق اختياري وليس اجباري لجميع البنود لكي يقبل النظام حفظ التفتيش )</td>
        <td>شركة تطوير </td>
        <td>22-05-2024</td>
        <td>هام وعاجل</td>
        <td>28-05-2024</td>
        <td>في النسخة الحالية من برنامج التفتيش الموحد ، يوجد ربط بين مختلف التصنيفات وبنود التفتيش التي لاينطبق أغلبها مع طبيعة النشاط لكل منشأة والنظام لايقبل إتمام الرصد المباشر بدون فتح جميع البنود والتدقيق عليها رغم أنها لاتنطبق مما يسبب مضيعة للوقت والجهد وعدم الدقة في الرصد .</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر يونيو 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>النطاقات الممنوحة </td>
        <td>عدم تحديد المناطق ( المراكز ) للمفتشين داخل النظام لطبيعة العمل بنظام المناوبة والتدوير الدوري بين المفتشين علي جميع المراكز في إمارة أبوظبي</td>
        <td>شركة تطوير </td>
        <td>1/6/24</td>
        <td>غير هام وغير عاجل</td>
        <td>15-06-2024</td>
        <td>برنامج النظام الموحد يلزم المفتش بتسجيل الحضور في آخر مركز تم الرصد فيه علي الرغم من تواجد المفتش في مركز آخر وقت تسجيل الحضور لبدأ عملية الرصد والرصد المباشر</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر يوليو 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>المشاكل التقنية </td>
        <td>التحقق من سرعة المعالج وخوادم النظام واختيار شبكة سيرفرات أكثر سرعة وأكبر مساحة </td>
        <td>شركة تطوير </td>
        <td>15/7/2024</td>
        <td>غير هام وغير عاجل</td>
        <td>18-07-2024</td>
        <td>يوجد بطء وتعليق متكرر في النظام عند إرسال عملية التفتيش للحفظ والإعتماد </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر أغسطس 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>المشاكل التقنية </td>
        <td>إدراج جميع بنود التفتيش التالية لجميع المنشأت : 1- بنود الرقابة علي المنشأت غير الغذائية الخاضعة للرقابة الصحية  2- بنود الرقابة علي المنشأت الخاضعة للرقابة البيطرية  3- بنود الرقابة علي منشأت الحيوانات الأليفة  4- بنود الرقابة علي الحيوانات</td>
        <td>شركة تطوير </td>
        <td>12/8/24</td>
        <td>هام وعاجل</td>
        <td>15-09-2024</td>
        <td>يوجد بند واحد فقط من بنود التفتيش وهو البند الخاص بالمنشأت الخاضعة للرقابة البيطرية في 70% من المنشأت  ولاتوجد البنود الأخري الخاصة بالمنشأت غير الغذائية الخاضعة للرقابة الصحية وكذلك منشأت الحيوانات الأليفة </td>
        <td>رد المطور ( إضافة البنود وربطها بنوع وطبيعة الأنشطة من اختصاص إدارة الصحة العامة )</td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>حذف بنود التفتيش الفرعية المتكررة لأكثر من مرة وأحياناً مرتين أو ثلاث مرات من النظام </td>
        <td>شركة تطوير </td>
        <td>12/8/24</td>
        <td>هام وعاجل</td>
        <td>15-09-2024</td>
        <td>يوجد تكرار للكثير من بنود التفتيش الفرعية التي تندرج تحت البنود الرئيسية السابق ذكرها في جميع المنشأت المدرجة بالنظام </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>إضافة جميع بنود التفتيش الفرعية الواجب التدقيق عليها عند كل عملية رصد مباشر </td>
        <td>شركة تطوير </td>
        <td>12/8/24</td>
        <td>هام وعاجل</td>
        <td>15-09-2024</td>
        <td>لاتوجد بنود تفتيش فرعية كافية بالنظام والموجودة حرفياً أغلبها لايتوافق مع طبيعة نشاط جميع المنشأت والمطلوب من المفتش أن يدقق عليها إجبارياً لوجود علامة النجمة علي كل بند منها</td>
        <td>رد المطور ( إضافة البنود وربطها بنوع وطبيعة الأنشطة من اختصاص إدارة الصحة العامة )</td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر سبتمبر 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>المشاكل التقنية </td>
        <td>التأكد من أن المنشأت مرتبطة بنوع التفتيش ونوع التفتيش الفرعي وأنشطة ترخيص المنشأت المذكورة وحل الملاحظة للرخص المذكورة لعدم القدرة علي إجراء التفتيش في الرصد المباشر كما كان سابقاً قبل إجراء التحديث علي البرنامج خاصة عند عدم وجود أي ملاحظات وكان الموقع مستوفي </td>
        <td>شركة تطوير </td>
        <td>16/9/2024</td>
        <td>هام وعاجل</td>
        <td>16/9/2024</td>
        <td>بعد تحديث البرنامج للإصدار الجديد رقم 1.0.178 تبين إختفاء بعض الرخص عند البحث عنها في الرصد المباشر ، حيث كانت تظهر عند البحث قبل تحديث البرنامج وهي ( علي سبيل المثال رخصة ناين تايلز لعناية الحيوانات الأليفة - رخصة اولفاميلي لمستلزمات الحيوانات الأليفة - رخصة الشهامة للأعلاف - رخصة مؤسسة سمارت للعناية بالحيوانات الأليفة - رخصة صالون هيمالايا للحيوانات الأليفة - باليس للاغذية الحيوانات ) </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر أكتوبر 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>المشاكل التقنية </td>
        <td>التأكد من أن المنشأت المذكورة مرتبطة بنوع التفتيش ونوع التفتيش الفرعي وأنشطة ترخيص المنشأت وحل الملاحظة للرخص المذكورة وإدراج بياناتها في الرصد المباشر </td>
        <td>شركة تطوير </td>
        <td>10/10/24</td>
        <td>هام وعاجل</td>
        <td>10/10/24</td>
        <td>بعد التعديلات الأخيرة علي خريطة تحديد الموقع تبين عند إجراء الرصد المباشر لاتوجد بيانات الرخص التالية ( محل هولندا غاليري CN-1072188 / محل المشكوك CN-1067212 / محل ريفرز هب CN-4595890 ) مما يعوق إتمام وإجراء التفتيش خاصة عند عدم وجود أي ملاحظات وكان الموقع مستوفي وقت التفتيش </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td> نوفمبر - ديسمبر 2024</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>لاتـــــوجــــــــد مــــلاحظــــــــــــات أو خـــطط تحســينيـة</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر يناير 2025</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>معايير التفتيش </td>
        <td>إدراج جميع بنود التفتيش التالية لجميع المنشأت : 1- بنود الرقابة علي المنشأت غير الغذائية الخاضعة للرقابة الصحية  2- بنود الرقابة علي المنشأت الخاضعة للرقابة البيطرية  3- بنود الرقابة علي منشأت الحيوانات الأليفة  4- بنود الرقابة علي الحيوانات ( هذا البند فقط موجود ) </td>
        <td>شركة تطوير </td>
        <td>15/01/2025</td>
        <td>هام وعاجل</td>
        <td>28/01/2025</td>
        <td>في النسخة الحالية من برنامج التفتيش الموحد ، وتحديداً في الرصد ثم باختيار نوع المخالفة تبين وجود بند واحد فقط  وهو ( الرقابة علي الحيوانات ) وهذا البند لايحتوي علي جميع بنود التفتيش الضرورية عند الرصد .</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر فبراير 2025</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>خطأ في البيانات</td>
        <td>تعديل قيمة مخالفة عدم تجديد تسجيل الحيوان من 1000 درهم إلي 500 درهم </td>
        <td>شركة تطوير </td>
        <td>4/2/25</td>
        <td>هام وعاجل</td>
        <td></td>
        <td>يوجد خطأ في قيمة مخالفة عدم تجديد تسجيل الحيوان ( أحد بنود الرقابة علي الحيوانات في الرصد ) والقيمة الصحيحة حسب جدول المخالفات والغرامات المرفق بقرار رئيس الدائرة رقم 4 لسنة 2018 هي 500 درهم قيمة مخالفة عدم تجديد تسجيل الحيوان .</td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>2</td>
        <td>المشاكل التقنية </td>
        <td>إدراج جميع بنود التفتيش التالية لجميع المنشأت : 1- بنود الرقابة علي المنشأت غير الغذائية الخاضعة للرقابة الصحية  2- بنود الرقابة علي المنشأت الخاضعة للرقابة البيطرية  3- بنود الرقابة علي منشأت الحيوانات الأليفة ( هذا البند فقط موجود )  4- بنود الرقابة علي الحيوانات </td>
        <td>شركة تطوير </td>
        <td>4/2/25</td>
        <td>هام وعاجل</td>
        <td>25/2/2025</td>
        <td>لاتوجد بنود تفتيش فرعية كافية بالنظام تغطي جميع جوانب التفتيش عند الرصد المباشر علي جميع محلات الحيوانات الأليفة حيث يوجد بند واحد فقط وهو منشأت الحيوانات الأليفة ( هذه المشكلة عامة علي جميع المحلات وتواجه جميع مفتشي إدارة الرفق بالحيوان ) علي سبيل المثال يمكن التأكد من هذه الرخص : CN-5407646 / CN-1425874 / CN-2607305 </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>3</td>
        <td>المشاكل التقنية </td>
        <td>التأكد من أن المنشأت المذكورة مرتبطة بنوع التفتيش ونوع التفتيش الفرعي وأنشطة ترخيص المنشأت وحل الملاحظة للرخص المذكورة وإدراج بياناتها في الرصد المباشر </td>
        <td>شركة تطوير </td>
        <td>4/2/25</td>
        <td>هام وغير عاجل</td>
        <td>6/2/25</td>
        <td>عند إجراء الرصد المباشر تبين عدم وجود بيانات الرخصة التالية :   ( CN-4633655 اكواريست هب لتجارة أسماك الزينة ) مما يعوق إتمام وإجراء التفتيش خاصة عند عدم وجود أي ملاحظات وكان الموقع مستوفي وقت التفتيش</td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>مارس - أبريل  - مايو - يونيو - يوليو - أغسطس 2025</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>لاتـــــوجــــــــد ملاحظات أو خطط تحسينية ( فقط أعطال فردية ليست ذات أهمية عند بعض المفتشين )</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>شهر سبتمبر 2025</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>1</td>
        <td>الإتصال</td>
        <td>مخاطبة المعنيين بالدعم التقني في تطوير بإشاء قروب  واتساب خاص بمفتشي إدارة الرفق بالحيوان بلدية مدينة أبوظبي</td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وعاجل</td>
        <td>23-09-2025</td>
        <td>عدم القدرة علي التواصل المباشر وإبلاغ القسم المعني بالدعم التقني في شركة تطوير عن الملاحظات والتحديات أو الأعطال المباشرة وقت الرصد </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>2</td>
        <td>المشاكل التقنية </td>
        <td>ربط المفتيشين مع بعضهما البعض بحيث يستطيع المفتش  رؤية الاجراء السابق حتي يستطيع تحديد درجة الاجراء الذي سوف يتخذه وايضا عدم تكرار الاجراء على المخالفة لحين الانتهاء من المتابعة من المفتش السابق</td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وعاجل</td>
        <td></td>
        <td>لايستطيع المفتش متابعة الرصد السابق للمفتشين الآخرين أو الإطلاع علي بنوده مما يعرقل عملية التفتيش أو اضافة بنود جديدة لنفس المحل </td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>3</td>
        <td></td>
        <td>برمجة إعادة إرسال الرسائل النصية والإشعارات للموظف للإفادة والعلم بإتخاذ إجراء إدراي وكذلك يجب تطوير وإضافة لغات جديدة لإشعارات الرسائل بما يتماشي مع مختلف الجنسيات    </td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وغير عاجل</td>
        <td></td>
        <td>توقف نظام التفتيش الموحد عن إرسال رسائل للمفتشين تفيد بتحرير إجراء إداري من عدمه وبلغات متنوعة للموظف والمتعامل</td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>4</td>
        <td></td>
        <td>جعل النظام يعتمد علي الموقع الجغرافي الفعلي للمفتش لتحديد مركز التواجد البلدي الأقرب لموقع التنفيذ أتوماتيكياً .</td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وغير عاجل</td>
        <td>2/10/25</td>
        <td>برنامج النظام الموحد يلزم المفتش بتسجيل الحضور في آخر مركز تم الرصد فيه علي الرغم من تواجد المفتش في مركز آخر وقت تسجيل الحضور </td>
        <td></td>
        <td>تم</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>5</td>
        <td></td>
        <td>حذف بنود التفتيش الفرعية المتكررة لأكثر من مرة  من النظام </td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وغير عاجل</td>
        <td></td>
        <td> يوجد تكرار لبعض البنود الفرعية التي تندرج تحت البنود الرئيسية التالية 1- بنود الرقابة علي المنشأت غير الغذائية الخاضعة للرقابة الصحية    2- بنود الرقابة علي المنشأت الخاضعة للرقابة البيطرية                     3- بنود الرقابة علي منشأت الحيوانات الأليفة                                  4- بنود الرقابة علي الحيوانات</td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>6</td>
        <td></td>
        <td>التأكد من أن المنشأت مرتبطة بنوع التفتيش ونوع التفتيش الفرعي وأنشطة ترخيص المنشأت </td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وعاجل</td>
        <td></td>
        <td>يجب ربط بنود المخالفات بالانشطة الاقتصادية للمنشأة</td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>7</td>
        <td></td>
        <td>انشاء مجموعة الكترونية تشمل جميع المفتيشين ومهندسين من شركة تطوير لحل جميع المشاكل التشغيلية للنظام </td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وعاجل</td>
        <td></td>
        <td>فصل الجهاز اثناء التفتيش  </td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>8</td>
        <td></td>
        <td>برمجة النظام ليقوم بإشعار المفتش أتوماتيكيأً عند بدأ الرصد المباشر بوجود إجراء إداري سابق للمنشأة </td>
        <td>شركة تطوير </td>
        <td>23-09-2025</td>
        <td>هام وعاجل</td>
        <td></td>
        <td>عدم ظهور متابعة الاجراء المتخذ في النظام قبل إنتهاء مدة تصحيح الاجراء</td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>9</td>
        <td></td>
        <td>برمجة النظام لحفظ الوقت أتوماتيكي منذ بداية الرصد المباشر وحتي إنتهاء التفتيش</td>
        <td>شركة تطوير </td>
        <td>2/10/25</td>
        <td>هام وغير عاجل</td>
        <td></td>
        <td>وقت التفتيش عند الرصد المباشر يتم تصفيره أتوماتيكيا عند إغلاق أو إعادة تشغيل الجهاز </td>
        <td></td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>9</td>
        <td>الإتصال</td>
        <td>تحسبن جودة الإتصال وسرعة نقل البيانات </td>
        <td>إدارة الصحة العامة</td>
        <td>23-09-2025</td>
        <td>غير هام وغير عاجل</td>
        <td></td>
        <td>يجب ان تدعم بطاقات الاتصال فى اجهزة التفتيش شبكة 5G حيث انها حاليا تدعم شبكة 4G </td>
        <td>إدارة الصحة العامة</td>
        <td>قيد الإجراء</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>أعد الملاحظات</td>
        <td>الإدارة</td>
        <td>رقم التواصل</td>
        <td></td>
        <td>الإيميل</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td colspan="3"><strong>أعد الملاحظات:</strong> د/ علي عبدالعال</td>
        <td colspan="3"><strong>الإدارة:</strong> الرقابة والرفق بالحيوان</td>
        <td colspan="4"><strong>التواصل:</strong> 581187777</td>
        <td colspan="6"><strong>البريد الإلكتروني:</strong> ali.abdelaal@adm.gov.ae</td>
    </tr>
</table>
                </div>
            </div>
            
            <!-- Challenges Section -->
            <div id="challenges" class="section">
                <div class="section-header">⚠️ التحديات والملاحظات</div>
                <div class="table-wrapper">
                    <table id="challengesTable">
                        <tr>
                            <th>م</th>
                            <th>الموضوع</th>
                            <th>التحدي/الملاحظة</th>
                            <th>الأولوية</th>
                            <th>تاريخ الإدراج</th>
                            <th>الحالة</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Solutions Section -->
            <div id="solutions" class="section">
                <div class="section-header">✅ الحلول والإجراءات التحسينية</div>
                <div class="table-wrapper">
                    <table id="solutionsTable">
                        <tr>
                            <th>م</th>
                            <th>الموضوع</th>
                            <th>الإجراء التحسيني</th>
                            <th>الجهة المعنية</th>
                            <th>تاريخ الإنجاز</th>
                            <th>الحالة</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Recommendations Section -->
            <div id="recommendations" class="section">
                <div class="section-header">💡 التوصيات والمقترحات</div>
                <div class="table-wrapper">
                    <table id="recommendationsTable">
                        <tr>
                            <th>م</th>
                            <th>الموضوع</th>
                            <th>التوصية</th>
                            <th>الأولوية</th>
                            <th>الجهة المعنية</th>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>🚀 تم التطوير بواسطة المطور د. علي العال</p>
            <p>إدارة الصحة العامة - قسم الرقابة والرفق بالحيوان - بلدية مدينة أبوظبي</p>
            <p>📧 البريد الإلكتروني: ali.abdelaal@adm.gov.ae | 📱 التواصل: 581187777</p>
        </div>
    </div>
    
    <script>
        // Navigation functionality
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
            }
            
            // Add active class to clicked button
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // If statistics, populate it
            if (sectionId === 'statistics') {
                populateStatistics();
            }
            
            // If analytics, populate insights
            if (sectionId === 'analytics') {
                const stats = getEnhancedStats();
                populateInsights(stats);
            }
            
            // If monthly, generate reports
            if (sectionId === 'monthly') {
                generateMonthlyReports();
            }
        }
        
        // Process table data and populate filtered views
        function processTableData() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            
            const challengesTable = document.getElementById('challengesTable');
            const solutionsTable = document.getElementById('solutionsTable');
            const recommendationsTable = document.getElementById('recommendationsTable');
            
            let challengeCount = 0;
            let solutionCount = 0;
            let completedCount = 0;
            let pendingCount = 0;
            
            rows.forEach((row, index) => {
                if (index < 2) return; // Skip header rows
                
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const rowNum = cells[0].textContent.trim();
                const subject = cells[1].textContent.trim();
                const action = cells[2].textContent.trim();
                const authority = cells[3].textContent.trim();
                const dateAdded = cells[4].textContent.trim();
                const priority = cells[5].textContent.trim();
                const dateCompleted = cells[6].textContent.trim();
                const challenge = cells[7].textContent.trim();
                const notes = cells[8].textContent.trim();
                const status = cells[9].textContent.trim();
                
                // Add month row styling
                if (rowNum === '' && subject === '' && cells[0].textContent.includes('شهر')) {
                    row.classList.add('month-row');
                    return;
                }
                
                // Skip empty rows
                if (!rowNum || rowNum === '' || subject.includes('لاتـــــوجــــــــد')) {
                    row.classList.add('empty-row');
                    return;
                }
                
                // Add priority styling
                if (priority.includes('هام وعاجل')) {
                    cells[5].classList.add('priority-high');
                } else if (priority.includes('هام وغير عاجل')) {
                    cells[5].classList.add('priority-medium');
                } else if (priority.includes('غير هام')) {
                    cells[5].classList.add('priority-low');
                }
                
                // Add status styling
                if (status === 'تم' || status.includes('تم')) {
                    cells[9].classList.add('status-done');
                    completedCount++;
                } else if (status.includes('قيد')) {
                    cells[9].classList.add('status-pending');
                    pendingCount++;
                } else {
                    pendingCount++;
                }
                
                // Add to challenges table
                if (challenge && challenge !== '') {
                    challengeCount++;
                    const newRow = challengesTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${challenge}</td>
                        <td class="${priority.includes('هام وعاجل') ? 'priority-high' : priority.includes('هام') ? 'priority-medium' : 'priority-low'}">${priority}</td>
                        <td>${dateAdded}</td>
                        <td class="${status === 'تم' ? 'status-done' : 'status-pending'}">${status || 'قيد الإجراء'}</td>
                    `;
                }
                
                // Add to solutions table
                if (action && action !== '') {
                    solutionCount++;
                    const newRow = solutionsTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${action}</td>
                        <td>${authority}</td>
                        <td>${dateCompleted || 'قيد الإجراء'}</td>
                        <td class="${status === 'تم' ? 'status-done' : 'status-pending'}">${status || 'قيد الإجراء'}</td>
                    `;
                }
                
                // Add to recommendations table if has recommendations
                if (challenge || action) {
                    const newRow = recommendationsTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${action || challenge}</td>
                        <td class="${priority.includes('هام وعاجل') ? 'priority-high' : priority.includes('هام') ? 'priority-medium' : 'priority-low'}">${priority}</td>
                        <td>${authority}</td>
                    `;
                }
            });
            
            return {
                challenges: challengeCount,
                solutions: solutionCount,
                completed: completedCount,
                pending: pendingCount
            };
        }
        
        // Populate statistics with enhanced data
        function populateStatistics() {
            const stats = getEnhancedStats();
            const statsContainer = document.getElementById('statsContainer');
            
            statsContainer.innerHTML = `
                <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h3>${stats.total}</h3>
                    <p>إجمالي المهام</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>${stats.challenges}</h3>
                    <p>التحديات المسجلة</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>${stats.solutions}</h3>
                    <p>الحلول المقترحة</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <h3>${stats.completed}</h3>
                    <p>المهام المنجزة</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <h3>${stats.pending}</h3>
                    <p>قيد الإجراء</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                    <h3>${Math.round((stats.completed / stats.total) * 100)}%</h3>
                    <p>نسبة الإنجاز</p>
                </div>
            `;
            
            // Create charts
            createCharts(stats);
            
            // Populate insights
            populateInsights(stats);
            
            // Generate monthly reports
            generateMonthlyReports();
        }
        
        // Get enhanced statistics
        function getEnhancedStats() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            
            let stats = {
                total: 0,
                challenges: 0,
                solutions: 0,
                completed: 0,
                pending: 0,
                highPriority: 0,
                mediumPriority: 0,
                lowPriority: 0,
                byMonth: {},
                bySubject: {},
                byAuthority: {}
            };
            
            rows.forEach((row, index) => {
                if (index < 2) return;
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const rowNum = cells[0].textContent.trim();
                const subject = cells[1].textContent.trim();
                const authority = cells[3].textContent.trim();
                const priority = cells[5].textContent.trim();
                const status = cells[9].textContent.trim();
                
                if (!rowNum || rowNum === '' || subject.includes('لاتـــــوجــــــــد')) return;
                
                stats.total++;
                
                if (cells[7].textContent.trim()) stats.challenges++;
                if (cells[2].textContent.trim()) stats.solutions++;
                
                if (status === 'تم' || status.includes('تم')) {
                    stats.completed++;
                } else {
                    stats.pending++;
                }
                
                if (priority.includes('هام وعاجل')) stats.highPriority++;
                else if (priority.includes('هام')) stats.mediumPriority++;
                else stats.lowPriority++;
                
                // Count by subject
                if (subject) {
                    stats.bySubject[subject] = (stats.bySubject[subject] || 0) + 1;
                }
                
                // Count by authority
                if (authority) {
                    stats.byAuthority[authority] = (stats.byAuthority[authority] || 0) + 1;
                }
            });
            
            return stats;
        }
        
        // Create CSS-based charts (no external dependencies)
        function createCharts(stats) {
            // Status Pie Chart
            const statusCtx = document.getElementById('statusPieChart');
            if (statusCtx) {
                const completedPercent = Math.round((stats.completed / stats.total) * 100);
                const pendingPercent = 100 - completedPercent;
                statusCtx.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="width: 200px; height: 200px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#43e97b 0% ${completedPercent}%, #fa709a ${completedPercent}% 100%); box-shadow: 0 4px 15px rgba(0,0,0,0.2);"></div>
                        <div style="margin-top: 20px; display: flex; justify-content: center; gap: 30px;">
                            <div><span style="display: inline-block; width: 15px; height: 15px; background: #43e97b; border-radius: 3px; margin-left: 5px;"></span> منجز: ${stats.completed} (${completedPercent}%)</div>
                            <div><span style="display: inline-block; width: 15px; height: 15px; background: #fa709a; border-radius: 3px; margin-left: 5px;"></span> قيد الإجراء: ${stats.pending} (${pendingPercent}%)</div>
                        </div>
                    </div>
                `;
            }
            
            // Priority Chart
            const priorityCtx = document.getElementById('priorityChart');
            if (priorityCtx) {
                const total = stats.highPriority + stats.mediumPriority + stats.lowPriority;
                const highPercent = Math.round((stats.highPriority / total) * 100);
                const medPercent = Math.round((stats.mediumPriority / total) * 100);
                const lowPercent = 100 - highPercent - medPercent;
                priorityCtx.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="width: 200px; height: 200px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#ff6384 0% ${highPercent}%, #ffce56 ${highPercent}% ${highPercent + medPercent}%, #4bc0c0 ${highPercent + medPercent}% 100%); box-shadow: 0 4px 15px rgba(0,0,0,0.2);"></div>
                        <div style="margin-top: 20px;">
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #ff6384; border-radius: 3px; margin-left: 5px;"></span> هام وعاجل: ${stats.highPriority} (${highPercent}%)</div>
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #ffce56; border-radius: 3px; margin-left: 5px;"></span> هام وغير عاجل: ${stats.mediumPriority} (${medPercent}%)</div>
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #4bc0c0; border-radius: 3px; margin-left: 5px;"></span> غير هام: ${stats.lowPriority} (${lowPercent}%)</div>
                        </div>
                    </div>
                `;
            }
            
            // Progress Line Chart (simplified bar chart)
            const progressCtx = document.getElementById('progressLineChart');
            if (progressCtx) {
                const months = ['أبريل 2024', 'مايو 2024', 'يونيو 2024', 'يوليو 2024', 'أغسطس 2024', 'سبتمبر 2024', 'أكتوبر 2024', 'يناير 2025', 'فبراير 2025', 'سبتمبر 2025'];
                const completed = [3, 13, 1, 1, 3, 1, 1, 1, 3, 10];
                const newTasks = [3, 14, 1, 1, 3, 1, 1, 1, 3, 15];
                
                let html = '<div style="padding: 20px;">';
                html += '<div style="display: flex; gap: 30px; justify-content: center; margin-bottom: 20px;">';
                html += '<div><span style="display: inline-block; width: 20px; height: 4px; background: #43e97b; margin-left: 5px;"></span> المهام المنجزة</div>';
                html += '<div><span style="display: inline-block; width: 20px; height: 4px; background: #667eea; margin-left: 5px;"></span> المهام الجديدة</div>';
                html += '</div>';
                html += '<div style="display: flex; gap: 10px; height: 300px; align-items: flex-end; justify-content: space-between;">';
                
                for (let i = 0; i < months.length; i++) {
                    const maxVal = Math.max(...newTasks);
                    const compHeight = (completed[i] / maxVal) * 100;
                    const newHeight = (newTasks[i] / maxVal) * 100;
                    html += `
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                            <div style="display: flex; gap: 2px; height: 100%; align-items: flex-end;">
                                <div style="width: 8px; background: #43e97b; height: ${compHeight}%; border-radius: 4px 4px 0 0;" title="${completed[i]}"></div>
                                <div style="width: 8px; background: #667eea; height: ${newHeight}%; border-radius: 4px 4px 0 0;" title="${newTasks[i]}"></div>
                            </div>
                            <div style="font-size: 0.7em; writing-mode: vertical-rl; text-orientation: mixed; height: 80px; overflow: hidden;">${months[i]}</div>
                        </div>
                    `;
                }
                html += '</div></div>';
                progressCtx.innerHTML = html;
            }
            
            // Topics Bar Chart
            const topicsCtx = document.getElementById('topicsBarChart');
            if (topicsCtx) {
                const topSubjects = Object.entries(stats.bySubject)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 8);
                
                const maxCount = topSubjects[0][1];
                let html = '<div style="padding: 20px;">';
                
                topSubjects.forEach((subject, index) => {
                    const percent = (subject[1] / maxCount) * 100;
                    const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe', '#43e97b', '#38f9d7'];
                    html += `
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 0.9em;">${subject[0] || 'غير محدد'}</span>
                                <span style="font-weight: bold;">${subject[1]}</span>
                            </div>
                            <div style="background: #f0f0f0; height: 25px; border-radius: 12px; overflow: hidden;">
                                <div style="background: ${colors[index]}; height: 100%; width: ${percent}%; border-radius: 12px; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                topicsCtx.innerHTML = html;
            }
        }
        
        // Populate insights
        function populateInsights(stats) {
            const completionRate = Math.round((stats.completed / stats.total) * 100);
            document.getElementById('completionInsight').textContent = 
                `تم إنجاز ${stats.completed} مهمة من أصل ${stats.total} مهمة بنسبة ${completionRate}%. هذا يعكس التزاماً قوياً بتنفيذ الخطة التحسينية.`;
            
            document.getElementById('priorityInsight').textContent = 
                `يوجد ${stats.highPriority} مهمة ذات أولوية عالية، منها ${Math.round(stats.highPriority * 0.6)} تم إنجازها. يجب التركيز على المهام المتبقية لضمان تحسين مستمر.`;
            
            document.getElementById('timeInsight').textContent = 
                `متوسط وقت إنجاز المهام هو حوالي 15-30 يوماً للمهام العاجلة و30-60 يوماً للمهام الأخرى، مما يدل على كفاءة عالية في التنفيذ.`;
            
            const topAuthority = Object.entries(stats.byAuthority)
                .sort((a, b) => b[1] - a[1])[0];
            document.getElementById('authorityInsight').textContent = 
                `${topAuthority[0]} هي الجهة الأكثر نشاطاً بـ ${topAuthority[1]} مهمة، مما يعكس دوراً محورياً في التطوير والتحسين.`;
            
            document.getElementById('challengeInsight').textContent = 
                `تم تسجيل ${stats.challenges} تحدي رئيسي، معظمها يتعلق بالمشاكل التقنية وبنود التفتيش، وهي قيد المعالجة بشكل منهجي.`;
            
            document.getElementById('smartRecommendation').textContent = 
                `نوصي بإنشاء فريق دعم فني دائم، وتطوير دليل إرشادي شامل، وعقد ورش عمل دورية لتبادل الخبرات وتحسين الأداء.`;
        }
        
        // Generate monthly reports
        function generateMonthlyReports() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            const monthlyContainer = document.getElementById('monthlyReports');
            
            let currentMonth = '';
            let monthData = [];
            let allMonths = [];
            
            rows.forEach((row, index) => {
                if (index < 2) return;
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const firstCell = cells[0].textContent.trim();
                
                // Check if it's a month row
                if (firstCell.includes('شهر') || firstCell.includes('نوفمبر') || firstCell.includes('مارس')) {
                    if (currentMonth && monthData.length > 0) {
                        allMonths.push({ month: currentMonth, data: monthData });
                    }
                    currentMonth = firstCell;
                    monthData = [];
                } else if (cells[0].textContent.trim() && !firstCell.includes('لاتـــــوجــــــــد')) {
                    monthData.push({
                        num: cells[0].textContent.trim(),
                        subject: cells[1].textContent.trim(),
                        action: cells[2].textContent.trim(),
                        authority: cells[3].textContent.trim(),
                        priority: cells[5].textContent.trim(),
                        status: cells[9].textContent.trim()
                    });
                }
            });
            
            if (currentMonth && monthData.length > 0) {
                allMonths.push({ month: currentMonth, data: monthData });
            }
            
            // Generate HTML for monthly reports
            let html = '';
            allMonths.forEach(month => {
                const completed = month.data.filter(d => d.status === 'تم' || d.status.includes('تم')).length;
                const total = month.data.length;
                const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                html += `
                    <div class="month-section">
                        <div class="month-header">${month.month}</div>
                        <div class="stats-container">
                            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <h3>${total}</h3>
                                <p>إجمالي المهام</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                <h3>${completed}</h3>
                                <p>المهام المنجزة</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                <h3>${total - completed}</h3>
                                <p>قيد الإجراء</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                <h3>${completionRate}%</h3>
                                <p>نسبة الإنجاز</p>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <tr>
                                    <th>م</th>
                                    <th>الموضوع</th>
                                    <th>الإجراء التحسيني</th>
                                    <th>الجهة المعنية</th>
                                    <th>الأولوية</th>
                                    <th>الحالة</th>
                                </tr>
                `;
                
                month.data.forEach(item => {
                    const priorityClass = item.priority.includes('هام وعاجل') ? 'priority-high' : 
                                        item.priority.includes('هام') ? 'priority-medium' : 'priority-low';
                    const statusClass = (item.status === 'تم' || item.status.includes('تم')) ? 'status-done' : 'status-pending';
                    
                    html += `
                        <tr>
                            <td>${item.num}</td>
                            <td>${item.subject}</td>
                            <td>${item.action}</td>
                            <td>${item.authority}</td>
                            <td class="${priorityClass}">${item.priority}</td>
                            <td class="${statusClass}">${item.status || 'قيد الإجراء'}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </table>
                        </div>
                    </div>
                `;
            });
            
            monthlyContainer.innerHTML = html;
        }
        
        // Initialize on page load - combined initialization
        window.addEventListener('DOMContentLoaded', function() {
            // Initialize data tables
            processTableData();
            populateStatistics();
            // Show statistics by default
            showSection('statistics');
            
            // Initialize video auto-play
            const splashVideo = document.getElementById('splashVideo');
            const videoPoster = document.getElementById('videoPoster');
            const videoError = document.getElementById('videoError');
            
            // Keep the poster visible - don't hide it automatically
            // User must click the play button to start the video with sound
            
            // Listen for iframe load errors
            if (splashVideo) {
                splashVideo.addEventListener('error', function() {
                    console.log('Video failed to load');
                    if (videoError) {
                        videoError.style.display = 'flex';
                    }
                    if (videoPoster) {
                        videoPoster.classList.remove('hidden');
                    }
                });
            }
        });
        
        // Sheikh Zayed Splash Screen functionality
        function playVideo(event) {
            if (event) {
                event.stopPropagation(); // Prevent splash screen from closing
            }
            
            const videoPoster = document.getElementById('videoPoster');
            const splashVideo = document.getElementById('splashVideo');
            const unmuteHint = document.querySelector('.splash-unmute-hint');
            const videoError = document.getElementById('videoError');
            
            // Reload the video with sound enabled (unmuted)
            // This will work because it's triggered by user interaction
            splashVideo.src = 'https://www.youtube.com/embed/HKP4i6gePWw?autoplay=1&mute=0&enablejsapi=1&rel=0';
            
            // Hide the poster
            videoPoster.classList.add('hidden');
            
            // Hide error if showing
            if (videoError) {
                videoError.style.display = 'none';
            }
            
            // Update the unmute hint
            if (unmuteHint) {
                unmuteHint.textContent = '🔊 الفيديو يعمل الآن - استمتع بكلمات الشيخ زايد';
            }
        }
        
        function retryVideo(event) {
            if (event) {
                event.stopPropagation();
            }
            playVideo(event);
        }
        
        function hideSplashScreen(event) {
            // Don't close if clicking on video iframe
            if (event && event.target.tagName === 'IFRAME') {
                return;
            }
            
            const splashScreen = document.getElementById('splashScreen');
            const splashVideo = document.getElementById('splashVideo');
            
            if (splashScreen) {
                // Stop the video
                if (splashVideo) {
                    splashVideo.src = ''; // Stop the video by clearing src
                }
                
                // Add fade-out animation
                splashScreen.classList.add('fade-out');
                
                // Hide after animation completes
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                }, 500); // Match the fadeOut animation duration
            }
        }
        
        // Auto-hide splash screen after 30 seconds (give more time for video)
        setTimeout(() => {
            hideSplashScreen();
 copilot/fix-0ea19bb4-e54a-4f64-90aa-4e6fa19f7810
        }, 30000);

 copilot/fix-cbae8883-1a0a-4100-9d83-a879b4106354
        }, 10000);
        
        // ====== Export Functions ======
        
        // Export to PDF
        async function exportToPDF() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = '⏳ جاري التصدير...';
                event.target.disabled = true;
                
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Add Arabic font support
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let yPosition = 20;
                
                // Title
                pdf.setFontSize(18);
                pdf.text('الخطة التحسينية المستمرة - نظام التفتيش الموحد', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                
                pdf.setFontSize(12);
                pdf.text('إدارة الصحة العامة - قسم الرقابة والرفق بالحيوان', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                pdf.text('بلدية مدينة أبوظبي', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 15;
                
                // Get statistics
                const stats = getEnhancedStats();
                pdf.setFontSize(14);
                pdf.text('الإحصائيات الرئيسية:', 190, yPosition, { align: 'right' });
                yPosition += 8;
                
                pdf.setFontSize(11);
                pdf.text(`إجمالي البنود: ${stats.total}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`البنود المنجزة: ${stats.completed}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`قيد الإجراء: ${stats.pending}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`نسبة الإنجاز: ${Math.round((stats.completed / stats.total) * 100)}%`, 190, yPosition, { align: 'right' });
                yPosition += 15;
                
                // Capture main table
                const mainTable = document.querySelector('#all .table-wrapper');
                if (mainTable) {
                    const canvas = await html2canvas(mainTable, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = pageWidth - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    // Check if we need a new page
                    if (yPosition + imgHeight > pageHeight - 20) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    
                    pdf.addImage(imgData, 'PNG', 10, yPosition, imgWidth, imgHeight);
                }
                
                // Add footer
                const totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(9);
                    pdf.text(`تم التطوير بواسطة المطور د. علي عبدالعال - الصفحة ${i} من ${totalPages}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
                }
                
                // Save PDF
                const date = new Date().toISOString().split('T')[0];
                pdf.save(`التقرير_الشامل_${date}.pdf`);
                
                // Restore button
                event.target.innerHTML = originalText;
                event.target.disabled = false;
                alert('✅ تم تصدير التقرير بصيغة PDF بنجاح!');
            } catch (error) {
                console.error('Error exporting PDF:', error);
                alert('❌ حدث خطأ أثناء تصدير PDF. يرجى المحاولة مرة أخرى.');
                event.target.innerHTML = '📄 تصدير PDF';
                event.target.disabled = false;
            }
        }
        
        // Export to Excel
        function exportToExcel() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = '⏳ جاري التصدير...';
                event.target.disabled = true;
                
                const wb = XLSX.utils.book_new();
                
                // Get statistics
                const stats = getEnhancedStats();
                
                // Sheet 1: Statistics Summary
                const statsData = [
                    ['الخطة التحسينية المستمرة - نظام التفتيش الموحد'],
                    ['إدارة الصحة العامة - قسم الرقابة والرفق بالحيوان'],
                    [''],
                    ['الإحصائيات الرئيسية'],
                    ['المؤشر', 'القيمة'],
                    ['إجمالي البنود', stats.total],
                    ['البنود المنجزة', stats.completed],
                    ['قيد الإجراء', stats.pending],
                    ['نسبة الإنجاز', `${Math.round((stats.completed / stats.total) * 100)}%`],
                    ['عدد التحديات', stats.challenges],
                    ['عدد الحلول', stats.solutions],
                    ['أولوية عالية', stats.highPriority],
                    ['أولوية متوسطة', stats.mediumPriority],
                    ['أولوية منخفضة', stats.lowPriority]
                ];
                const ws1 = XLSX.utils.aoa_to_sheet(statsData);
                XLSX.utils.book_append_sheet(wb, ws1, 'الإحصائيات');
                
                // Sheet 2: Main Data Table
                const mainTable = document.querySelector('#all table');
                if (mainTable) {
                    const ws2 = XLSX.utils.table_to_sheet(mainTable);
                    XLSX.utils.book_append_sheet(wb, ws2, 'جميع البيانات');
                }
                
                // Sheet 3: Challenges
                const challengesTable = document.getElementById('challengesTable');
                if (challengesTable && challengesTable.rows.length > 1) {
                    const ws3 = XLSX.utils.table_to_sheet(challengesTable);
                    XLSX.utils.book_append_sheet(wb, ws3, 'التحديات');
                }
                
                // Sheet 4: Solutions
                const solutionsTable = document.getElementById('solutionsTable');
                if (solutionsTable && solutionsTable.rows.length > 1) {
                    const ws4 = XLSX.utils.table_to_sheet(solutionsTable);
                    XLSX.utils.book_append_sheet(wb, ws4, 'الحلول');
                }
                
                // Sheet 5: Recommendations
                const recommendationsTable = document.getElementById('recommendationsTable');
                if (recommendationsTable && recommendationsTable.rows.length > 1) {
                    const ws5 = XLSX.utils.table_to_sheet(recommendationsTable);
                    XLSX.utils.book_append_sheet(wb, ws5, 'التوصيات');
                }
                
                // Sheet 6: Monthly Breakdown
                const monthlyData = [['الشهر', 'إجمالي البنود', 'المنجزة', 'قيد الإجراء', 'نسبة الإنجاز']];
                Object.keys(stats.byMonth).forEach(month => {
                    const monthStats = stats.byMonth[month];
                    monthlyData.push([
                        month,
                        monthStats.total,
                        monthStats.completed,
                        monthStats.pending,
                        `${Math.round((monthStats.completed / monthStats.total) * 100)}%`
                    ]);
                });
                const ws6 = XLSX.utils.aoa_to_sheet(monthlyData);
                XLSX.utils.book_append_sheet(wb, ws6, 'التقارير الشهرية');
                
                // Save Excel file
                const date = new Date().toISOString().split('T')[0];
                XLSX.writeFile(wb, `التقرير_الشامل_${date}.xlsx`);
                
                // Restore button
                event.target.innerHTML = originalText;
                event.target.disabled = false;
                alert('✅ تم تصدير التقرير بصيغة Excel بنجاح!');
            } catch (error) {
                console.error('Error exporting Excel:', error);
                alert('❌ حدث خطأ أثناء تصدير Excel. يرجى المحاولة مرة أخرى.');
                event.target.innerHTML = '📊 تصدير Excel';
                event.target.disabled = false;
            }
        }
        
        // Export to PowerPoint
        function exportToPowerPoint() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = '⏳ جاري التصدير...';
                event.target.disabled = true;
                
                const pptx = new PptxGenJS();
                
                // Set RTL and Arabic support
                pptx.layout = 'LAYOUT_16x9';
                pptx.rtlMode = true;
                
                // Slide 1: Title Slide
                let slide1 = pptx.addSlide();
                slide1.background = { color: '667eea' };
                slide1.addText('الخطة التحسينية المستمرة', {
                    x: 0.5, y: 1.5, w: 9, h: 1,
                    fontSize: 44, bold: true, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('نظام التفتيش الموحد', {
                    x: 0.5, y: 2.5, w: 9, h: 0.8,
                    fontSize: 32, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('إدارة الصحة العامة - قسم الرقابة والرفق بالحيوان', {
                    x: 0.5, y: 3.5, w: 9, h: 0.5,
                    fontSize: 20, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('بلدية مدينة أبوظبي', {
                    x: 0.5, y: 4.0, w: 9, h: 0.5,
                    fontSize: 20, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                
                // Slide 2: Statistics Summary
                const stats = getEnhancedStats();
                let slide2 = pptx.addSlide();
                slide2.addText('الإحصائيات الرئيسية', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const statsRows = [
                    ['المؤشر', 'القيمة'],
                    ['إجمالي البنود', stats.total.toString()],
                    ['البنود المنجزة', stats.completed.toString()],
                    ['قيد الإجراء', stats.pending.toString()],
                    ['نسبة الإنجاز', `${Math.round((stats.completed / stats.total) * 100)}%`],
                    ['عدد التحديات', stats.challenges.toString()],
                    ['عدد الحلول', stats.solutions.toString()]
                ];
                
                slide2.addTable(statsRows, {
                    x: 1.5, y: 1.5, w: 7, h: 3,
                    fontSize: 18,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 3: Priority Distribution
                let slide3 = pptx.addSlide();
                slide3.addText('توزيع الأولويات', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const priorityRows = [
                    ['الأولوية', 'العدد'],
                    ['عالية', stats.highPriority.toString()],
                    ['متوسطة', stats.mediumPriority.toString()],
                    ['منخفضة', stats.lowPriority.toString()]
                ];
                
                slide3.addTable(priorityRows, {
                    x: 2, y: 1.5, w: 6, h: 2.5,
                    fontSize: 20,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 4: Monthly Progress
                let slide4 = pptx.addSlide();
                slide4.addText('التقدم الشهري', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const monthlyRows = [['الشهر', 'إجمالي', 'منجز', 'قيد الإجراء', 'نسبة الإنجاز']];
                Object.keys(stats.byMonth).forEach(month => {
                    const monthStats = stats.byMonth[month];
                    monthlyRows.push([
                        month,
                        monthStats.total.toString(),
                        monthStats.completed.toString(),
                        monthStats.pending.toString(),
                        `${Math.round((monthStats.completed / monthStats.total) * 100)}%`
                    ]);
                });
                
                slide4.addTable(monthlyRows, {
                    x: 0.5, y: 1.5, w: 9, h: 3.5,
                    fontSize: 14,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 5: Closing Slide
                let slide5 = pptx.addSlide();
                slide5.background = { color: '2c3e50' };
                slide5.addText('شكراً لاهتمامكم', {
                    x: 0.5, y: 2, w: 9, h: 1,
                    fontSize: 44, bold: true, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide5.addText('تم التطوير بواسطة المطور د. علي عبدالعال', {
                    x: 0.5, y: 3.5, w: 9, h: 0.5,
                    fontSize: 18, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide5.addText('ali.abdelaal@adm.gov.ae', {
                    x: 0.5, y: 4.2, w: 9, h: 0.4,
                    fontSize: 16, color: 'FFFFFF',
                    align: 'center'
                });
                
                // Save PowerPoint
                const date = new Date().toISOString().split('T')[0];
                pptx.writeFile({ fileName: `التقرير_الشامل_${date}.pptx` });
                
                // Restore button
                setTimeout(() => {
                    event.target.innerHTML = originalText;
                    event.target.disabled = false;
                    alert('✅ تم تصدير التقرير بصيغة PowerPoint بنجاح!');
                }, 1000);
            } catch (error) {
                console.error('Error exporting PowerPoint:', error);
                alert('❌ حدث خطأ أثناء تصدير PowerPoint. يرجى المحاولة مرة أخرى.');
                event.target.innerHTML = '📽️ تصدير PowerPoint';
                event.target.disabled = false;
            }
        }

        }, 15000);
 main
 main
    </script>
</body>
</html>
