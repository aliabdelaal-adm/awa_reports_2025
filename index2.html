<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ‚Ø±ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ù…ÙˆØ­Ø¯</title>
    
    <!-- Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.12.0/pptxgen.bundle.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            direction: rtl;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before,
        body::after {
            content: '';
            position: fixed;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            opacity: 0.1;
            z-index: 0;
            pointer-events: none;
        }
        
        body::before {
            background: radial-gradient(circle, #fff 0%, transparent 70%);
            top: -100px;
            left: -100px;
            animation: float 6s ease-in-out infinite;
        }
        
        body::after {
            background: radial-gradient(circle, #fff 0%, transparent 70%);
            bottom: -100px;
            right: -100px;
            animation: float 8s ease-in-out infinite reverse;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
            z-index: 1;
            animation: zoomIn 0.8s ease;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            background-size: 200% 200%;
            animation: gradientShift 5s ease infinite;
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::after {
            content: 'âœ¨';
            position: absolute;
            font-size: 3em;
            opacity: 0.1;
            animation: float 3s ease-in-out infinite;
            top: 20px;
            right: 50px;
        }
        
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            animation: fadeInUp 1s ease;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .navigation {
            background: #ecf0f1;
            padding: 15px 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #3498db;
        }
        
        .nav-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        .nav-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .nav-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .nav-button:hover {
            background: #2980b9;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .nav-button.active {
            background: #27ae60;
            animation: pulse 2s infinite;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .section-header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            animation: slideInRight 0.6s ease;
            position: relative;
            overflow: hidden;
        }
        
        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        .table-wrapper {
            overflow-x: auto;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #2c3e50;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 12px 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
            transform: scale(1.01);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.2);
            transition: all 0.3s ease;
        }
        
        .month-row {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%) !important;
            color: white !important;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .month-row td {
            border-color: #27ae60 !important;
        }
        
        .priority-high {
            background-color: #ffebee;
            color: #c62828;
            font-weight: bold;
        }
        
        .priority-medium {
            background-color: #fff8e1;
            color: #f57c00;
            font-weight: bold;
        }
        
        .priority-low {
            background-color: #e8f5e9;
            color: #2e7d32;
            font-weight: bold;
        }
        
        .status-done {
            background-color: #c8e6c9;
            color: #1b5e20;
            font-weight: bold;
        }
        
        .status-pending {
            background-color: #fff9c4;
            color: #f57f17;
            font-weight: bold;
        }
        
        .empty-row {
            background-color: #f5f5f5 !important;
            font-style: italic;
            color: #757575;
        }
        
        .footer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1em;
            animation: fadeInUp 1s ease;
            position: relative;
            overflow: hidden;
        }
        
        .footer::before {
            content: 'ğŸŒŸ';
            position: absolute;
            font-size: 5em;
            opacity: 0.05;
            left: 10%;
            animation: float 4s ease-in-out infinite;
        }
        
        .footer::after {
            content: 'âœ¨';
            position: absolute;
            font-size: 3em;
            opacity: 0.05;
            right: 15%;
            top: 10px;
            animation: float 5s ease-in-out infinite reverse;
        }
        
        .footer p {
            position: relative;
            z-index: 1;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            animation: bounceIn 0.8s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }
        
        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            animation: glow 2s infinite;
        }
        
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            font-size: 1em;
            opacity: 0.9;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .insight-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
            animation: slideIn 0.8s ease;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .insight-card:hover {
            transform: translateX(-10px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
            border-left-width: 8px;
        }
        
        .insight-card::after {
            content: 'âœ¨';
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .insight-card:hover::after {
            opacity: 1;
            animation: float 2s infinite;
        }
        
        .insight-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .insight-card p {
            color: #555;
            line-height: 1.6;
        }
        
        .suggestion-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            animation: zoomIn 0.6s ease, float 3s ease-in-out infinite;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .suggestion-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .suggestion-card:hover::before {
            left: 100%;
        }
        
        .suggestion-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 30px rgba(245, 87, 108, 0.4);
        }
        
        .suggestion-card h4 {
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }
        
        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(-30px);
            }
            50% {
                opacity: 0.9;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.95);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes glow {
            0%, 100% {
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }
            50% {
                box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
        }
        
        .section.active {
            animation: fadeIn 0.5s ease;
        }
        
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .chart-container {
            animation: fadeInUp 0.8s ease;
        }
        
        .month-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            animation: slideIn 0.6s ease;
            transition: all 0.3s ease;
        }
        
        .month-section:hover {
            transform: translateX(-5px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }
        
        .month-header {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .month-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 3s infinite;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .navigation {
                padding: 10px;
            }
            
            .nav-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
            
            .content {
                padding: 15px;
            }
            
            th, td {
                padding: 8px 5px;
                font-size: 0.9em;
            }
        }
        
        /* Screen Switcher Styles */
        .screen-switcher {
            background: #34495e;
            padding: 10px 30px;
            display: flex;
            gap: 10px;
            justify-content: center;
            border-bottom: 2px solid #2c3e50;
        }
        
        .screen-switch-btn {
            background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s;
            font-weight: bold;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .screen-switch-btn:hover {
            background: linear-gradient(135deg, #1abc9c 0%, #48c9b0 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22, 160, 133, 0.4);
        }
        
        .screen-switch-btn.current {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            cursor: default;
        }
        
        .screen-switch-btn.current:hover {
            transform: none;
            box-shadow: none;
        }
        
 main
        /* Export Buttons Styles */
        .export-section {
            background: #ecf0f1;
            padding: 15px 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #e74c3c;
        }
        
        .export-button {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .export-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .export-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .export-button:hover {
            background: linear-gradient(135deg, #c0392b 0%, #922b21 100%);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
        }
        
        .export-button.excel {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .export-button.excel:hover {
            background: linear-gradient(135deg, #229954 0%, #1e8449 100%);
        }
        
        .export-button.powerpoint {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }
        
        .export-button.powerpoint:hover {
            background: linear-gradient(135deg, #d35400 0%, #ba4a00 100%);
        }
        
        @media (max-width: 768px) {
            .export-section {
                padding: 10px;
            }
            
            .export-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
 main
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ù…ÙˆØ­Ø¯</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© - Ù‚Ø³Ù… Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© ÙˆØ§Ù„Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù† - Ø¨Ù„Ø¯ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø£Ø¨ÙˆØ¸Ø¨ÙŠ</p>
        </div>
        
        <!-- Screen Switcher -->
        <div class="screen-switcher">
            <a href="index.html" class="screen-switch-btn">
                ğŸ“‹ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ©
            </a>
            <span class="screen-switch-btn current">
                ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ
            </span>
        </div>
        
        <div class="navigation">
            <button class="nav-button" onclick="showSection('statistics', event)">ğŸ“ˆ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠØ©</button>
            <button class="nav-button" onclick="showSection('analytics', event)">ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</button>
            <button class="nav-button" onclick="showSection('monthly', event)">ğŸ“… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</button>
            <button class="nav-button" onclick="showSection('challenges', event)">âš ï¸ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</button>
            <button class="nav-button" onclick="showSection('solutions', event)">âœ… Ø§Ù„Ø­Ù„ÙˆÙ„ ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</button>
            <button class="nav-button" onclick="showSection('recommendations', event)">ğŸ’¡ Ø§Ù„ØªÙˆØµÙŠØ§Øª</button>
            <button class="nav-button" onclick="showSection('suggestions', event)">ğŸš€ Ù…Ù‚ØªØ±Ø­Ø§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±</button>
            <button class="nav-button active" onclick="showSection('all', event)">ğŸ“‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
        
        <!-- Export Section for System Administrator -->
        <div class="export-section">
            <button class="export-button" onclick="exportToPDF()">
                ğŸ“„ ØªØµØ¯ÙŠØ± PDF
            </button>
            <button class="export-button excel" onclick="exportToExcel()">
                ğŸ“Š ØªØµØ¯ÙŠØ± Excel
            </button>
            <button class="export-button powerpoint" onclick="exportToPowerPoint()">
                ğŸ“½ï¸ ØªØµØ¯ÙŠØ± PowerPoint
            </button>
        </div>
        
        <div class="content">
            <!-- Enhanced Statistics Dashboard -->
            <div id="statistics" class="section">
                <div class="section-header">ğŸ“ˆ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠØ© - Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ</div>
                
                <!-- Key Performance Indicators -->
                <div class="stats-container" id="statsContainer">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <!-- Charts Section -->
                <div class="analytics-grid">
                    <div class="chart-container">
                        <div class="chart-title">ğŸ“Š ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©</div>
                        <div class="chart-wrapper" id="statusPieChart">
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">â±ï¸ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</div>
                        <div class="chart-wrapper" id="priorityChart">
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">ğŸ“ˆ Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø´Ù‡Ø±ÙŠ ÙÙŠ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</div>
                    <div class="chart-wrapper" id="progressLineChart">
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">ğŸ¢ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ø£ÙƒØ«Ø± ØªÙƒØ±Ø§Ø±Ø§Ù‹</div>
                    <div class="chart-wrapper" id="topicsBarChart">
                    </div>
                </div>
            </div>
            
            <!-- Advanced Analytics Section -->
            <div id="analytics" class="section">
                <div class="section-header">ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆØ§Ù„Ø±Ø¤Ù‰ Ø§Ù„Ø°ÙƒÙŠØ©</div>
                
                <div class="analytics-grid">
                    <div class="insight-card">
                        <h4>ğŸ“Œ Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</h4>
                        <p id="completionInsight">ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>âš¡ Ø§Ù„Ù…Ù‡Ø§Ù… Ø°Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©</h4>
                        <p id="priorityInsight">ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>ğŸ“… Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</h4>
                        <p id="timeInsight">ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>ğŸ¯ Ø£ÙƒØ«Ø± Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ© Ù†Ø´Ø§Ø·Ø§Ù‹</h4>
                        <p id="authorityInsight">ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>ğŸ“Š ØªÙˆØ²ÙŠØ¹ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª</h4>
                        <p id="challengeInsight">ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>âœ¨ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø°ÙƒÙŠØ©</h4>
                        <p id="smartRecommendation">ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª...</p>
                    </div>
                </div>
            </div>
            
            <!-- Monthly Reports Section -->
            <div id="monthly" class="section">
                <div class="section-header">ğŸ“… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ø§Ù„Ù…ÙØµÙ„Ø©</div>
                <div id="monthlyReports">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Suggestions Section -->
            <div id="suggestions" class="section">
                <div class="section-header">ğŸš€ Ù…Ù‚ØªØ±Ø­Ø§Øª Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ©</div>
                
                <div class="suggestion-card">
                    <h4>ğŸ¤– Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙŠ Ø§Ù„ØªÙØªÙŠØ´</h4>
                    <p>ØªØ·ÙˆÙŠØ± Ù†Ø¸Ø§Ù… Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© ÙˆØ£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ù„ÙˆÙƒØŒ Ù…Ù…Ø§ ÙŠØ³Ø§Ø¹Ø¯ ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø§Ø³ØªØ¨Ø§Ù‚ÙŠ ÙˆØªØ­Ø³ÙŠÙ† ÙƒÙØ§Ø¡Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙØªÙŠØ´.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ“± ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù…</h4>
                    <p>ØªØ·ÙˆÙŠØ± ØªØ·Ø¨ÙŠÙ‚ Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù…ØªÙƒØ§Ù…Ù„ Ù…Ø¹ ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù… Ø³Ù‡Ù„Ø© ÙˆØ¨Ø¯ÙŠÙ‡ÙŠØ©ØŒ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¹Ù…Ù„ Ø¯ÙˆÙ† Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†ØªØŒ Ù…Ø¹ Ù…Ø²Ø§Ù…Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ ØªÙˆÙØ± Ø§Ù„Ø§ØªØµØ§Ù„ØŒ ÙˆØ¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙˆØ±ÙŠØ© Ù„Ù„Ù…ÙØªØ´ÙŠÙ†.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ”— Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©</h4>
                    <p>Ø±Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªØ±Ø®ÙŠØµ ÙˆØ§Ù„Ø±Ø®Øµ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ø®Ø±Ø§Ø¦Ø· Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙˆØ£Ù†Ø¸Ù…Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ØŒ Ù„ØªÙˆÙÙŠØ± Ø±Ø¤ÙŠØ© Ø´Ø§Ù…Ù„Ø© ÙˆÙ…ØªÙƒØ§Ù…Ù„Ø© Ø¹Ù† Ø­Ø§Ù„Ø© ÙƒÙ„ Ù…Ù†Ø´Ø£Ø©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ØªÙØ§Ø¹Ù„ÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©</h4>
                    <p>ØªØ·ÙˆÙŠØ± Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø¨ØªØ­Ù„ÙŠÙ„Ø§Øª ÙÙˆØ±ÙŠØ© ÙˆØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø®ØµØµØ© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØµØ¯ÙŠØ±ØŒ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØ®ØµÙŠØµ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ Ù‚Ø³Ù….</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ“ Ù†Ø¸Ø§Ù… ØªØ¯Ø±ÙŠØ¨ ÙˆØªØ·ÙˆÙŠØ± Ø§Ù„Ù…ÙØªØ´ÙŠÙ†</h4>
                    <p>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ÙØªØ´ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ ÙˆØ§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†ØŒ Ù…Ø¹ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ØªÙ‚ÙŠÙŠÙ…ÙŠØ© Ø¯ÙˆØ±ÙŠØ© ÙˆØ´Ù‡Ø§Ø¯Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø©ØŒ Ù„Ø¶Ù…Ø§Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ” Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø°ÙƒÙŠ</h4>
                    <p>ØªØ·ÙˆÙŠØ± Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ù…ØªÙ‚Ø¯Ù… ÙŠØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ§Øª GPS Ùˆ Geofencing Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ÙØªØ´ÙŠÙ† ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ ÙˆØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Ø¨ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙƒÙØ§Ø¡Ø©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ’¬ Ù†Ø¸Ø§Ù… ØªÙˆØ§ØµÙ„ Ù…ÙˆØ­Ø¯</h4>
                    <p>Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ù†ÙˆØ§Øª ØªÙˆØ§ØµÙ„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…ÙØªØ´ÙŠÙ† ÙˆØ§Ù„Ù…Ø´Ø±ÙÙŠÙ† ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>ğŸ† Ù†Ø¸Ø§Ù… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø­ÙˆØ§ÙØ²</h4>
                    <p>ØªØ·ÙˆÙŠØ± Ù†Ø¸Ø§Ù… Ø¢Ù„ÙŠ Ù„ØªÙ‚ÙŠÙŠÙ… Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙØªØ´ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¹Ø§ÙŠÙŠØ± Ù…ÙˆØ¶ÙˆØ¹ÙŠØ©ØŒ Ù…Ø¹ Ù„ÙˆØ­Ø© Ø´Ø±Ù ÙˆØ­ÙˆØ§ÙØ² ØªØ´Ø¬ÙŠØ¹ÙŠØ© Ù„Ù„Ù…ØªÙ…ÙŠØ²ÙŠÙ†ØŒ Ù…Ù…Ø§ ÙŠØ¹Ø²Ø² Ø§Ù„ØªÙ†Ø§ÙØ³ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©.</p>
                </div>
            </div>
            
            <!-- All Data Section -->
            <div id="all" class="section active">
                <div class="section-header">ğŸ“Š Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</div>
                <div class="table-wrapper">
<table>
    <tr>
        <th colspan="16">ØªÙ‚Ø±ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ù…ÙˆØ­Ø¯ - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø©</th>
    </tr>
    <tr>
        <th>Ù…</th>
        <th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
        <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
        <th>Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù†ÙŠØ©</th>
        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
        <th>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</th>
        <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
        <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</th>
        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
        <th colspan="6">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</th>
    </tr>
    <tr>
        <td colspan="16" style="text-align: center; padding: 40px; font-size: 1.2em; color: #7f8c8d; background: #ecf0f1;">
            <div style="font-size: 3em; margin-bottom: 20px;">ğŸ“‹</div>
            <strong>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯</strong>
            <br><br>
            <p style="margin: 15px 0; line-height: 1.8;">
                Ù‡Ø°Ø§ Ù†Ù…ÙˆØ°Ø¬ ØªÙ‚Ø±ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…Ù†ÙØµÙ„ ØªÙ…Ø§Ù…Ø§Ù‹ Ø¹Ù† Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ©.<br>
                ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ø¯ÙˆÙ† Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ© Ø§Ù„Ø£ØµÙ„ÙŠØ©.
            </p>
            <p style="margin: 15px 0; color: #16a085; font-weight: bold;">
                ğŸ“ Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙÙŠ Ù…Ù„Ù <code>report-data.html</code>
            </p>
            <p style="margin: 15px 0; font-size: 0.9em; color: #95a5a6;">
                Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ©" Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
            </p>
        </td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>Ø£Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</td>
        <td>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</td>
        <td>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</td>
        <td></td>
        <td>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td colspan="3"><strong>Ø£Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ±:</strong> Ø¯/ Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ù„</td>
        <td colspan="3"><strong>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:</strong> Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© ÙˆØ§Ù„Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù†</td>
        <td colspan="4"><strong>Ø§Ù„ØªÙˆØ§ØµÙ„:</strong> 581187777</td>
        <td colspan="6"><strong>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</strong> ali.abdelaal@adm.gov.ae</td>
    </tr>
</table>
</table>
                </div>
            </div>
            
            <!-- Challenges Section -->
            <div id="challenges" class="section">
                <div class="section-header">âš ï¸ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
                <div class="table-wrapper">
                    <table id="challengesTable">
                        <tr>
                            <th>Ù…</th>
                            <th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
                            <th>Ø§Ù„ØªØ­Ø¯ÙŠ/Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</th>
                            <th>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¯Ø±Ø§Ø¬</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Solutions Section -->
            <div id="solutions" class="section">
                <div class="section-header">âœ… Ø§Ù„Ø­Ù„ÙˆÙ„ ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ©</div>
                <div class="table-wrapper">
                    <table id="solutionsTable">
                        <tr>
                            <th>Ù…</th>
                            <th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠ</th>
                            <th>Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù†ÙŠØ©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Recommendations Section -->
            <div id="recommendations" class="section">
                <div class="section-header">ğŸ’¡ Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ù…Ù‚ØªØ±Ø­Ø§Øª</div>
                <div class="table-wrapper">
                    <table id="recommendationsTable">
                        <tr>
                            <th>Ù…</th>
                            <th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
                            <th>Ø§Ù„ØªÙˆØµÙŠØ©</th>
                            <th>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
                            <th>Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù†ÙŠØ©</th>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>ğŸš€ ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø©  Ø¯. Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ù„</p>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© - Ù‚Ø³Ù… Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© ÙˆØ§Ù„Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù† - Ø¨Ù„Ø¯ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø£Ø¨ÙˆØ¸Ø¨ÙŠ</p>
            <p>ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ali.abdelaal@adm.gov.ae | ğŸ“± Ø§Ù„ØªÙˆØ§ØµÙ„: 0581187777</p>
        </div>
    </div>
    
    <script>
        // Navigation functionality
        function showSection(sectionId, clickEvent) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
            }
            
            // Add active class to clicked button
            if (clickEvent && clickEvent.target) {
                clickEvent.target.classList.add('active');
            }
            
            // If statistics, populate it
            if (sectionId === 'statistics') {
                populateStatistics();
            }
            
            // If analytics, populate insights
            if (sectionId === 'analytics') {
                const stats = getEnhancedStats();
                populateInsights(stats);
            }
            
            // If monthly, generate reports
            if (sectionId === 'monthly') {
                generateMonthlyReports();
            }
        }
        
        // Process table data and populate filtered views
        function processTableData() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            
            const challengesTable = document.getElementById('challengesTable');
            const solutionsTable = document.getElementById('solutionsTable');
            const recommendationsTable = document.getElementById('recommendationsTable');
            
            let challengeCount = 0;
            let solutionCount = 0;
            let completedCount = 0;
            let pendingCount = 0;
            
            rows.forEach((row, index) => {
                if (index < 2) return; // Skip header rows
                
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const rowNum = cells[0].textContent.trim();
                const subject = cells[1].textContent.trim();
                const action = cells[2].textContent.trim();
                const authority = cells[3].textContent.trim();
                const dateAdded = cells[4].textContent.trim();
                const priority = cells[5].textContent.trim();
                const dateCompleted = cells[6].textContent.trim();
                const challenge = cells[7].textContent.trim();
                const notes = cells[8].textContent.trim();
                const status = cells[9].textContent.trim();
                
                // Add month row styling
                if (rowNum === '' && subject === '' && cells[0].textContent.includes('Ø´Ù‡Ø±')) {
                    row.classList.add('month-row');
                    return;
                }
                
                // Skip empty rows
                if (!rowNum || rowNum === '' || subject.includes('Ù„Ø§ØªÙ€Ù€Ù€Ù€Ù€ÙˆØ¬Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ø¯')) {
                    row.classList.add('empty-row');
                    return;
                }
                
                // Add priority styling
                if (priority.includes('Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„')) {
                    cells[5].classList.add('priority-high');
                } else if (priority.includes('Ù‡Ø§Ù… ÙˆØºÙŠØ± Ø¹Ø§Ø¬Ù„')) {
                    cells[5].classList.add('priority-medium');
                } else if (priority.includes('ØºÙŠØ± Ù‡Ø§Ù…')) {
                    cells[5].classList.add('priority-low');
                }
                
                // Add status styling
                if (status === 'ØªÙ…' || status.includes('ØªÙ…')) {
                    cells[9].classList.add('status-done');
                    completedCount++;
                } else if (status.includes('Ù‚ÙŠØ¯')) {
                    cells[9].classList.add('status-pending');
                    pendingCount++;
                } else {
                    pendingCount++;
                }
                
                // Add to challenges table
                if (challenge && challenge !== '') {
                    challengeCount++;
                    const newRow = challengesTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${challenge}</td>
                        <td class="${priority.includes('Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„') ? 'priority-high' : priority.includes('Ù‡Ø§Ù…') ? 'priority-medium' : 'priority-low'}">${priority}</td>
                        <td>${dateAdded}</td>
                        <td class="${status === 'ØªÙ…' ? 'status-done' : 'status-pending'}">${status || 'Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡'}</td>
                    `;
                }
                
                // Add to solutions table
                if (action && action !== '') {
                    solutionCount++;
                    const newRow = solutionsTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${action}</td>
                        <td>${authority}</td>
                        <td>${dateCompleted || 'Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡'}</td>
                        <td class="${status === 'ØªÙ…' ? 'status-done' : 'status-pending'}">${status || 'Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡'}</td>
                    `;
                }
                
                // Add to recommendations table if has recommendations
                if (challenge || action) {
                    const newRow = recommendationsTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${action || challenge}</td>
                        <td class="${priority.includes('Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„') ? 'priority-high' : priority.includes('Ù‡Ø§Ù…') ? 'priority-medium' : 'priority-low'}">${priority}</td>
                        <td>${authority}</td>
                    `;
                }
            });
            
            return {
                challenges: challengeCount,
                solutions: solutionCount,
                completed: completedCount,
                pending: pendingCount
            };
        }
        
        // Animate number counter
        function animateCounter(element, target, duration = 1500, isPercentage = false) {
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = isPercentage ? Math.round(target) + '%' : Math.round(target);
                    clearInterval(timer);
                } else {
                    element.textContent = isPercentage ? Math.round(current) + '%' : Math.round(current);
                }
            }, 16);
        }
        
        // Populate statistics with enhanced data
        function populateStatistics() {
            const stats = getEnhancedStats();
            const statsContainer = document.getElementById('statsContainer');
            
            statsContainer.innerHTML = `
                <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); animation-delay: 0s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ“Š</div>
                    <h3 class="counter" data-target="${stats.total}">0</h3>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); animation-delay: 0.1s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">âš ï¸</div>
                    <h3 class="counter" data-target="${stats.challenges}">0</h3>
                    <p>Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); animation-delay: 0.2s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ’¡</div>
                    <h3 class="counter" data-target="${stats.solutions}">0</h3>
                    <p>Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); animation-delay: 0.3s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">âœ…</div>
                    <h3 class="counter" data-target="${stats.completed}">0</h3>
                    <p>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); animation-delay: 0.4s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ”„</div>
                    <h3 class="counter" data-target="${stats.pending}">0</h3>
                    <p>Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); animation-delay: 0.5s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ“ˆ</div>
                    <h3 class="counter" data-target="${Math.round((stats.completed / stats.total) * 100)}" data-percentage="true">0%</h3>
                    <p>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</p>
                </div>
            `;
            
            // Animate all counters
            setTimeout(() => {
                document.querySelectorAll('.counter').forEach(counter => {
                    const target = parseInt(counter.getAttribute('data-target'));
                    const isPercentage = counter.hasAttribute('data-percentage');
                    animateCounter(counter, target, 1500, isPercentage);
                });
            }, 300);
            
            // Create charts
            createCharts(stats);
            
            // Populate insights
            populateInsights(stats);
            
            // Generate monthly reports
            generateMonthlyReports();
        }
        
        // Get enhanced statistics
        function getEnhancedStats() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            
            let stats = {
                total: 0,
                challenges: 0,
                solutions: 0,
                completed: 0,
                pending: 0,
                highPriority: 0,
                mediumPriority: 0,
                lowPriority: 0,
                byMonth: {},
                bySubject: {},
                byAuthority: {}
            };
            
            rows.forEach((row, index) => {
                if (index < 2) return;
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const rowNum = cells[0].textContent.trim();
                const subject = cells[1].textContent.trim();
                const authority = cells[3].textContent.trim();
                const priority = cells[5].textContent.trim();
                const status = cells[9].textContent.trim();
                
                if (!rowNum || rowNum === '' || subject.includes('Ù„Ø§ØªÙ€Ù€Ù€Ù€Ù€ÙˆØ¬Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ø¯')) return;
                
                stats.total++;
                
                if (cells[7].textContent.trim()) stats.challenges++;
                if (cells[2].textContent.trim()) stats.solutions++;
                
                if (status === 'ØªÙ…' || status.includes('ØªÙ…')) {
                    stats.completed++;
                } else {
                    stats.pending++;
                }
                
                if (priority.includes('Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„')) stats.highPriority++;
                else if (priority.includes('Ù‡Ø§Ù…')) stats.mediumPriority++;
                else stats.lowPriority++;
                
                // Count by subject
                if (subject) {
                    stats.bySubject[subject] = (stats.bySubject[subject] || 0) + 1;
                }
                
                // Count by authority
                if (authority) {
                    stats.byAuthority[authority] = (stats.byAuthority[authority] || 0) + 1;
                }
            });
            
            return stats;
        }
        
        // Create CSS-based charts (no external dependencies)
        function createCharts(stats) {
            // Status Pie Chart
            const statusCtx = document.getElementById('statusPieChart');
            if (statusCtx) {
                const completedPercent = Math.round((stats.completed / stats.total) * 100);
                const pendingPercent = 100 - completedPercent;
                statusCtx.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="width: 200px; height: 200px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#43e97b 0% ${completedPercent}%, #fa709a ${completedPercent}% 100%); box-shadow: 0 4px 15px rgba(0,0,0,0.2);"></div>
                        <div style="margin-top: 20px; display: flex; justify-content: center; gap: 30px;">
                            <div><span style="display: inline-block; width: 15px; height: 15px; background: #43e97b; border-radius: 3px; margin-left: 5px;"></span> Ù…Ù†Ø¬Ø²: ${stats.completed} (${completedPercent}%)</div>
                            <div><span style="display: inline-block; width: 15px; height: 15px; background: #fa709a; border-radius: 3px; margin-left: 5px;"></span> Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡: ${stats.pending} (${pendingPercent}%)</div>
                        </div>
                    </div>
                `;
            }
            
            // Priority Chart
            const priorityCtx = document.getElementById('priorityChart');
            if (priorityCtx) {
                const total = stats.highPriority + stats.mediumPriority + stats.lowPriority;
                const highPercent = Math.round((stats.highPriority / total) * 100);
                const medPercent = Math.round((stats.mediumPriority / total) * 100);
                const lowPercent = 100 - highPercent - medPercent;
                priorityCtx.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="width: 200px; height: 200px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#ff6384 0% ${highPercent}%, #ffce56 ${highPercent}% ${highPercent + medPercent}%, #4bc0c0 ${highPercent + medPercent}% 100%); box-shadow: 0 4px 15px rgba(0,0,0,0.2);"></div>
                        <div style="margin-top: 20px;">
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #ff6384; border-radius: 3px; margin-left: 5px;"></span> Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„: ${stats.highPriority} (${highPercent}%)</div>
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #ffce56; border-radius: 3px; margin-left: 5px;"></span> Ù‡Ø§Ù… ÙˆØºÙŠØ± Ø¹Ø§Ø¬Ù„: ${stats.mediumPriority} (${medPercent}%)</div>
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #4bc0c0; border-radius: 3px; margin-left: 5px;"></span> ØºÙŠØ± Ù‡Ø§Ù…: ${stats.lowPriority} (${lowPercent}%)</div>
                        </div>
                    </div>
                `;
            }
            
            // Progress Line Chart (simplified bar chart)
            const progressCtx = document.getElementById('progressLineChart');
            if (progressCtx) {
                const months = ['Ø£Ø¨Ø±ÙŠÙ„ 2024', 'Ù…Ø§ÙŠÙˆ 2024', 'ÙŠÙˆÙ†ÙŠÙˆ 2024', 'ÙŠÙˆÙ„ÙŠÙˆ 2024', 'Ø£ØºØ³Ø·Ø³ 2024', 'Ø³Ø¨ØªÙ…Ø¨Ø± 2024', 'Ø£ÙƒØªÙˆØ¨Ø± 2024', 'ÙŠÙ†Ø§ÙŠØ± 2025', 'ÙØ¨Ø±Ø§ÙŠØ± 2025', 'Ø³Ø¨ØªÙ…Ø¨Ø± 2025'];
                const completed = [3, 13, 1, 1, 3, 1, 1, 1, 3, 10];
                const newTasks = [3, 14, 1, 1, 3, 1, 1, 1, 3, 15];
                
                let html = '<div style="padding: 20px;">';
                html += '<div style="display: flex; gap: 30px; justify-content: center; margin-bottom: 20px;">';
                html += '<div><span style="display: inline-block; width: 20px; height: 4px; background: #43e97b; margin-left: 5px;"></span> Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©</div>';
                html += '<div><span style="display: inline-block; width: 20px; height: 4px; background: #667eea; margin-left: 5px;"></span> Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>';
                html += '</div>';
                html += '<div style="display: flex; gap: 10px; height: 300px; align-items: flex-end; justify-content: space-between;">';
                
                for (let i = 0; i < months.length; i++) {
                    const maxVal = Math.max(...newTasks);
                    const compHeight = (completed[i] / maxVal) * 100;
                    const newHeight = (newTasks[i] / maxVal) * 100;
                    html += `
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                            <div style="display: flex; gap: 2px; height: 100%; align-items: flex-end;">
                                <div style="width: 8px; background: #43e97b; height: ${compHeight}%; border-radius: 4px 4px 0 0;" title="${completed[i]}"></div>
                                <div style="width: 8px; background: #667eea; height: ${newHeight}%; border-radius: 4px 4px 0 0;" title="${newTasks[i]}"></div>
                            </div>
                            <div style="font-size: 0.7em; writing-mode: vertical-rl; text-orientation: mixed; height: 80px; overflow: hidden;">${months[i]}</div>
                        </div>
                    `;
                }
                html += '</div></div>';
                progressCtx.innerHTML = html;
            }
            
            // Topics Bar Chart
            const topicsCtx = document.getElementById('topicsBarChart');
            if (topicsCtx) {
                const topSubjects = Object.entries(stats.bySubject)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 8);
                
                const maxCount = topSubjects[0][1];
                let html = '<div style="padding: 20px;">';
                
                topSubjects.forEach((subject, index) => {
                    const percent = (subject[1] / maxCount) * 100;
                    const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe', '#43e97b', '#38f9d7'];
                    html += `
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 0.9em;">${subject[0] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                <span style="font-weight: bold;">${subject[1]}</span>
                            </div>
                            <div style="background: #f0f0f0; height: 25px; border-radius: 12px; overflow: hidden;">
                                <div style="background: ${colors[index]}; height: 100%; width: ${percent}%; border-radius: 12px; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                topicsCtx.innerHTML = html;
            }
        }
        
        // Populate insights
        function populateInsights(stats) {
            const completionRate = Math.round((stats.completed / stats.total) * 100);
            document.getElementById('completionInsight').textContent = 
                `ØªÙ… Ø¥Ù†Ø¬Ø§Ø² ${stats.completed} Ù…Ù‡Ù…Ø© Ù…Ù† Ø£ØµÙ„ ${stats.total} Ù…Ù‡Ù…Ø© Ø¨Ù†Ø³Ø¨Ø© ${completionRate}%. Ù‡Ø°Ø§ ÙŠØ¹ÙƒØ³ Ø§Ù„ØªØ²Ø§Ù…Ø§Ù‹ Ù‚ÙˆÙŠØ§Ù‹ Ø¨ØªÙ†ÙÙŠØ° Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ©.`;
            
            document.getElementById('priorityInsight').textContent = 
                `ÙŠÙˆØ¬Ø¯ ${stats.highPriority} Ù…Ù‡Ù…Ø© Ø°Ø§Øª Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©ØŒ Ù…Ù†Ù‡Ø§ ${Math.round(stats.highPriority * 0.6)} ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡Ø§. ÙŠØ¬Ø¨ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ù„Ø¶Ù…Ø§Ù† ØªØ­Ø³ÙŠÙ† Ù…Ø³ØªÙ…Ø±.`;
            
            document.getElementById('timeInsight').textContent = 
                `Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ù‡Ø§Ù… Ù‡Ùˆ Ø­ÙˆØ§Ù„ÙŠ 15-30 ÙŠÙˆÙ…Ø§Ù‹ Ù„Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø¹Ø§Ø¬Ù„Ø© Ùˆ30-60 ÙŠÙˆÙ…Ø§Ù‹ Ù„Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰ØŒ Ù…Ù…Ø§ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°.`;
            
            const topAuthority = Object.entries(stats.byAuthority)
                .sort((a, b) => b[1] - a[1])[0];
            document.getElementById('authorityInsight').textContent = 
                `${topAuthority[0]} Ù‡ÙŠ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ø£ÙƒØ«Ø± Ù†Ø´Ø§Ø·Ø§Ù‹ Ø¨Ù€ ${topAuthority[1]} Ù…Ù‡Ù…Ø©ØŒ Ù…Ù…Ø§ ÙŠØ¹ÙƒØ³ Ø¯ÙˆØ±Ø§Ù‹ Ù…Ø­ÙˆØ±ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†.`;
            
            document.getElementById('challengeInsight').textContent = 
                `ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${stats.challenges} ØªØ­Ø¯ÙŠ Ø±Ø¦ÙŠØ³ÙŠØŒ Ù…Ø¹Ø¸Ù…Ù‡Ø§ ÙŠØªØ¹Ù„Ù‚ Ø¨Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙ‚Ù†ÙŠØ© ÙˆØ¨Ù†ÙˆØ¯ Ø§Ù„ØªÙØªÙŠØ´ØŒ ÙˆÙ‡ÙŠ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ø´ÙƒÙ„ Ù…Ù†Ù‡Ø¬ÙŠ.`;
            
            document.getElementById('smartRecommendation').textContent = 
                `Ù†ÙˆØµÙŠ Ø¨Ø¥Ù†Ø´Ø§Ø¡ ÙØ±ÙŠÙ‚ Ø¯Ø¹Ù… ÙÙ†ÙŠ Ø¯Ø§Ø¦Ù…ØŒ ÙˆØªØ·ÙˆÙŠØ± Ø¯Ù„ÙŠÙ„ Ø¥Ø±Ø´Ø§Ø¯ÙŠ Ø´Ø§Ù…Ù„ØŒ ÙˆØ¹Ù‚Ø¯ ÙˆØ±Ø´ Ø¹Ù…Ù„ Ø¯ÙˆØ±ÙŠØ© Ù„ØªØ¨Ø§Ø¯Ù„ Ø§Ù„Ø®Ø¨Ø±Ø§Øª ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡.`;
        }
        
        // Generate monthly reports
        function generateMonthlyReports() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            const monthlyContainer = document.getElementById('monthlyReports');
            
            let currentMonth = '';
            let monthData = [];
            let allMonths = [];
            
            rows.forEach((row, index) => {
                if (index < 2) return;
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const firstCell = cells[0].textContent.trim();
                
                // Check if it's a month row
                if (firstCell.includes('Ø´Ù‡Ø±') || firstCell.includes('Ù†ÙˆÙÙ…Ø¨Ø±') || firstCell.includes('Ù…Ø§Ø±Ø³')) {
                    if (currentMonth && monthData.length > 0) {
                        allMonths.push({ month: currentMonth, data: monthData });
                    }
                    currentMonth = firstCell;
                    monthData = [];
                } else if (cells[0].textContent.trim() && !firstCell.includes('Ù„Ø§ØªÙ€Ù€Ù€Ù€Ù€ÙˆØ¬Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ø¯')) {
                    monthData.push({
                        num: cells[0].textContent.trim(),
                        subject: cells[1].textContent.trim(),
                        action: cells[2].textContent.trim(),
                        authority: cells[3].textContent.trim(),
                        priority: cells[5].textContent.trim(),
                        status: cells[9].textContent.trim()
                    });
                }
            });
            
            if (currentMonth && monthData.length > 0) {
                allMonths.push({ month: currentMonth, data: monthData });
            }
            
            // Generate HTML for monthly reports
            let html = '';
            allMonths.forEach(month => {
                const completed = month.data.filter(d => d.status === 'ØªÙ…' || d.status.includes('ØªÙ…')).length;
                const total = month.data.length;
                const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                html += `
                    <div class="month-section">
                        <div class="month-header">${month.month}</div>
                        <div class="stats-container">
                            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <h3>${total}</h3>
                                <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                <h3>${completed}</h3>
                                <p>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                <h3>${total - completed}</h3>
                                <p>Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                <h3>${completionRate}%</h3>
                                <p>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</p>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <tr>
                                    <th>Ù…</th>
                                    <th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
                                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠ</th>
                                    <th>Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù†ÙŠØ©</th>
                                    <th>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
                                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                </tr>
                `;
                
                month.data.forEach(item => {
                    const priorityClass = item.priority.includes('Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„') ? 'priority-high' : 
                                        item.priority.includes('Ù‡Ø§Ù…') ? 'priority-medium' : 'priority-low';
                    const statusClass = (item.status === 'ØªÙ…' || item.status.includes('ØªÙ…')) ? 'status-done' : 'status-pending';
                    
                    html += `
                        <tr>
                            <td>${item.num}</td>
                            <td>${item.subject}</td>
                            <td>${item.action}</td>
                            <td>${item.authority}</td>
                            <td class="${priorityClass}">${item.priority}</td>
                            <td class="${statusClass}">${item.status || 'Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡'}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </table>
                        </div>
                    </div>
                `;
            });
            
            monthlyContainer.innerHTML = html;
        }
        
        // Initialize on page load - combined initialization
        window.addEventListener('DOMContentLoaded', function() {
            // Initialize data tables
            processTableData();
            populateStatistics();
            // Show statistics by default
            showSection('statistics');
        });
        
 main
        // ====== Export Functions ======
        
        // Export to PDF
        async function exportToPDF() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...';
                event.target.disabled = true;
                
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Add Arabic font support
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let yPosition = 20;
                
                // Title
                pdf.setFontSize(18);
                pdf.text('Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø© - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ù…ÙˆØ­Ø¯', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                
                pdf.setFontSize(12);
                pdf.text('Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù†', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                pdf.text('Ø¨Ù„Ø¯ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø£Ø¨ÙˆØ¸Ø¨ÙŠ', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 15;
                
                // Get statistics
                const stats = getEnhancedStats();
                pdf.setFontSize(14);
                pdf.text('Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:', 190, yPosition, { align: 'right' });
                yPosition += 8;
                
                pdf.setFontSize(11);
                pdf.text(`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯: ${stats.total}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù†Ø¬Ø²Ø©: ${stats.completed}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡: ${stats.pending}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²: ${Math.round((stats.completed / stats.total) * 100)}%`, 190, yPosition, { align: 'right' });
                yPosition += 15;
                
                // Capture main table
                const mainTable = document.querySelector('#all .table-wrapper');
                if (mainTable) {
                    const canvas = await html2canvas(mainTable, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = pageWidth - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    // Check if we need a new page
                    if (yPosition + imgHeight > pageHeight - 20) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    
                    pdf.addImage(imgData, 'PNG', 10, yPosition, imgWidth, imgHeight);
                }
                
                // Add footer
                const totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(9);
                    pdf.text(`ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø©  Ø¯. Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ù„ - Ø§Ù„ØµÙØ­Ø© ${i} Ù…Ù† ${totalPages}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
                }
                
                // Save PDF
                const date = new Date().toISOString().split('T')[0];
                pdf.save(`Ø§Ù„ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø´Ø§Ù…Ù„_${date}.pdf`);
                
                // Restore button
                event.target.innerHTML = originalText;
                event.target.disabled = false;
                alert('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ØµÙŠØºØ© PDF Ø¨Ù†Ø¬Ø§Ø­!');
            } catch (error) {
                console.error('Error exporting PDF:', error);
                alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± PDF. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                event.target.innerHTML = 'ğŸ“„ ØªØµØ¯ÙŠØ± PDF';
                event.target.disabled = false;
            }
        }
        
        // Export to Excel
        function exportToExcel() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...';
                event.target.disabled = true;
                
                const wb = XLSX.utils.book_new();
                
                // Get statistics
                const stats = getEnhancedStats();
                
                // Sheet 1: Statistics Summary
                const statsData = [
                    ['Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø© - Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ù…ÙˆØ­Ø¯'],
                    ['Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© - Ù‚Ø³Ù… Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© ÙˆØ§Ù„Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù†'],
                    [''],
                    ['Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©'],
                    ['Ø§Ù„Ù…Ø¤Ø´Ø±', 'Ø§Ù„Ù‚ÙŠÙ…Ø©'],
                    ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯', stats.total],
                    ['Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù†Ø¬Ø²Ø©', stats.completed],
                    ['Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', stats.pending],
                    ['Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²', `${Math.round((stats.completed / stats.total) * 100)}%`],
                    ['Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª', stats.challenges],
                    ['Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù„ÙˆÙ„', stats.solutions],
                    ['Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©', stats.highPriority],
                    ['Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©', stats.mediumPriority],
                    ['Ø£ÙˆÙ„ÙˆÙŠØ© Ù…Ù†Ø®ÙØ¶Ø©', stats.lowPriority]
                ];
                const ws1 = XLSX.utils.aoa_to_sheet(statsData);
                XLSX.utils.book_append_sheet(wb, ws1, 'Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª');
                
                // Sheet 2: Main Data Table
                const mainTable = document.querySelector('#all table');
                if (mainTable) {
                    const ws2 = XLSX.utils.table_to_sheet(mainTable);
                    XLSX.utils.book_append_sheet(wb, ws2, 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
                
                // Sheet 3: Challenges
                const challengesTable = document.getElementById('challengesTable');
                if (challengesTable && challengesTable.rows.length > 1) {
                    const ws3 = XLSX.utils.table_to_sheet(challengesTable);
                    XLSX.utils.book_append_sheet(wb, ws3, 'Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª');
                }
                
                // Sheet 4: Solutions
                const solutionsTable = document.getElementById('solutionsTable');
                if (solutionsTable && solutionsTable.rows.length > 1) {
                    const ws4 = XLSX.utils.table_to_sheet(solutionsTable);
                    XLSX.utils.book_append_sheet(wb, ws4, 'Ø§Ù„Ø­Ù„ÙˆÙ„');
                }
                
                // Sheet 5: Recommendations
                const recommendationsTable = document.getElementById('recommendationsTable');
                if (recommendationsTable && recommendationsTable.rows.length > 1) {
                    const ws5 = XLSX.utils.table_to_sheet(recommendationsTable);
                    XLSX.utils.book_append_sheet(wb, ws5, 'Ø§Ù„ØªÙˆØµÙŠØ§Øª');
                }
                
                // Sheet 6: Monthly Breakdown
                const monthlyData = [['Ø§Ù„Ø´Ù‡Ø±', 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯', 'Ø§Ù„Ù…Ù†Ø¬Ø²Ø©', 'Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²']];
                Object.keys(stats.byMonth).forEach(month => {
                    const monthStats = stats.byMonth[month];
                    monthlyData.push([
                        month,
                        monthStats.total,
                        monthStats.completed,
                        monthStats.pending,
                        `${Math.round((monthStats.completed / monthStats.total) * 100)}%`
                    ]);
                });
                const ws6 = XLSX.utils.aoa_to_sheet(monthlyData);
                XLSX.utils.book_append_sheet(wb, ws6, 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠØ©');
                
                // Save Excel file
                const date = new Date().toISOString().split('T')[0];
                XLSX.writeFile(wb, `Ø§Ù„ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø´Ø§Ù…Ù„_${date}.xlsx`);
                
                // Restore button
                event.target.innerHTML = originalText;
                event.target.disabled = false;
                alert('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ØµÙŠØºØ© Excel Ø¨Ù†Ø¬Ø§Ø­!');
            } catch (error) {
                console.error('Error exporting Excel:', error);
                alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Excel. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                event.target.innerHTML = 'ğŸ“Š ØªØµØ¯ÙŠØ± Excel';
                event.target.disabled = false;
            }
        }
        
        // Export to PowerPoint
        function exportToPowerPoint() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...';
                event.target.disabled = true;
                
                const pptx = new PptxGenJS();
                
                // Set RTL and Arabic support
                pptx.layout = 'LAYOUT_16x9';
                pptx.rtlMode = true;
                
                // Slide 1: Title Slide
                let slide1 = pptx.addSlide();
                slide1.background = { color: '667eea' };
                slide1.addText('Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø©', {
                    x: 0.5, y: 1.5, w: 9, h: 1,
                    fontSize: 44, bold: true, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙØªÙŠØ´ Ø§Ù„Ù…ÙˆØ­Ø¯', {
                    x: 0.5, y: 2.5, w: 9, h: 0.8,
                    fontSize: 32, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© - Ù‚Ø³Ù… Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© ÙˆØ§Ù„Ø±ÙÙ‚ Ø¨Ø§Ù„Ø­ÙŠÙˆØ§Ù†', {
                    x: 0.5, y: 3.5, w: 9, h: 0.5,
                    fontSize: 20, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('Ø¨Ù„Ø¯ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø£Ø¨ÙˆØ¸Ø¨ÙŠ', {
                    x: 0.5, y: 4.0, w: 9, h: 0.5,
                    fontSize: 20, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                
                // Slide 2: Statistics Summary
                const stats = getEnhancedStats();
                let slide2 = pptx.addSlide();
                slide2.addText('Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const statsRows = [
                    ['Ø§Ù„Ù…Ø¤Ø´Ø±', 'Ø§Ù„Ù‚ÙŠÙ…Ø©'],
                    ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯', stats.total.toString()],
                    ['Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù†Ø¬Ø²Ø©', stats.completed.toString()],
                    ['Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', stats.pending.toString()],
                    ['Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²', `${Math.round((stats.completed / stats.total) * 100)}%`],
                    ['Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª', stats.challenges.toString()],
                    ['Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ù„ÙˆÙ„', stats.solutions.toString()]
                ];
                
                slide2.addTable(statsRows, {
                    x: 1.5, y: 1.5, w: 7, h: 3,
                    fontSize: 18,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 3: Priority Distribution
                let slide3 = pptx.addSlide();
                slide3.addText('ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const priorityRows = [
                    ['Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©', 'Ø§Ù„Ø¹Ø¯Ø¯'],
                    ['Ø¹Ø§Ù„ÙŠØ©', stats.highPriority.toString()],
                    ['Ù…ØªÙˆØ³Ø·Ø©', stats.mediumPriority.toString()],
                    ['Ù…Ù†Ø®ÙØ¶Ø©', stats.lowPriority.toString()]
                ];
                
                slide3.addTable(priorityRows, {
                    x: 2, y: 1.5, w: 6, h: 2.5,
                    fontSize: 20,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 4: Monthly Progress
                let slide4 = pptx.addSlide();
                slide4.addText('Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø´Ù‡Ø±ÙŠ', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const monthlyRows = [['Ø§Ù„Ø´Ù‡Ø±', 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ', 'Ù…Ù†Ø¬Ø²', 'Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡', 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²']];
                Object.keys(stats.byMonth).forEach(month => {
                    const monthStats = stats.byMonth[month];
                    monthlyRows.push([
                        month,
                        monthStats.total.toString(),
                        monthStats.completed.toString(),
                        monthStats.pending.toString(),
                        `${Math.round((monthStats.completed / monthStats.total) * 100)}%`
                    ]);
                });
                
                slide4.addTable(monthlyRows, {
                    x: 0.5, y: 1.5, w: 9, h: 3.5,
                    fontSize: 14,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 5: Closing Slide
                let slide5 = pptx.addSlide();
                slide5.background = { color: '2c3e50' };
                slide5.addText('Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ù‡ØªÙ…Ø§Ù…ÙƒÙ…', {
                    x: 0.5, y: 2, w: 9, h: 1,
                    fontSize: 44, bold: true, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide5.addText('ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø©  Ø¯. Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø§Ù„', {
                    x: 0.5, y: 3.5, w: 9, h: 0.5,
                    fontSize: 18, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide5.addText('ali.abdelaal@adm.gov.ae', {
                    x: 0.5, y: 4.2, w: 9, h: 0.4,
                    fontSize: 16, color: 'FFFFFF',
                    align: 'center'
                });
                
                // Save PowerPoint
                const date = new Date().toISOString().split('T')[0];
                pptx.writeFile({ fileName: `Ø§Ù„ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø´Ø§Ù…Ù„_${date}.pptx` });
                
                // Restore button
                setTimeout(() => {
                    event.target.innerHTML = originalText;
                    event.target.disabled = false;
                    alert('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ØµÙŠØºØ© PowerPoint Ø¨Ù†Ø¬Ø§Ø­!');
                }, 1000);
            } catch (error) {
                console.error('Error exporting PowerPoint:', error);
                alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± PowerPoint. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                event.target.innerHTML = 'ğŸ“½ï¸ ØªØµØ¯ÙŠØ± PowerPoint';
                event.target.disabled = false;
            }
        }
        
        // Initialize scroll reveal animations
        function initScrollAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            // Observe all cards
            document.querySelectorAll('.stat-card, .insight-card, .suggestion-card, .chart-container').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(el);
            });
        }
        
        // Add staggered animation to table rows
        function animateTableRows() {
            const rows = document.querySelectorAll('#all table tr');
            rows.forEach((row, index) => {
                if (index > 1) { // Skip header rows
                    row.style.opacity = '0';
                    row.style.transform = 'translateX(-20px)';
                    setTimeout(() => {
                        row.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                        row.style.opacity = '1';
                        row.style.transform = 'translateX(0)';
                    }, index * 30);
                }
            });
        }
        
        // Add sparkle effect to icons
        function addSparkleEffect() {
            const icons = document.querySelectorAll('.stat-card > div, .section-header');
            icons.forEach(icon => {
                icon.style.cursor = 'pointer';
                icon.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.2) rotate(10deg)';
                    this.style.transition = 'transform 0.3s ease';
                });
                icon.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1) rotate(0deg)';
                });
            });
        }
        
        // Initialize all animations on page load
        window.addEventListener('load', () => {
            initScrollAnimations();
            animateTableRows();
            addSparkleEffect();
            
            // Show statistics section by default with animation
            setTimeout(() => {
                document.getElementById('statistics').classList.add('active');
                populateStatistics();
            }, 500);
        });
    </script>
</body>
</html>
