<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÿ™ŸÇÿ±Ÿäÿ± ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä - ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ ÿßŸÑŸÖŸàÿ≠ÿØ</title>
    
    <!-- Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.12.0/pptxgen.bundle.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            direction: rtl;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before,
        body::after {
            content: '';
            position: fixed;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            opacity: 0.1;
            z-index: 0;
            pointer-events: none;
        }
        
        body::before {
            background: radial-gradient(circle, #fff 0%, transparent 70%);
            top: -100px;
            left: -100px;
            animation: float 6s ease-in-out infinite;
        }
        
        body::after {
            background: radial-gradient(circle, #fff 0%, transparent 70%);
            bottom: -100px;
            right: -100px;
            animation: float 8s ease-in-out infinite reverse;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
            z-index: 1;
            animation: zoomIn 0.8s ease;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            background-size: 200% 200%;
            animation: gradientShift 5s ease infinite;
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::after {
            content: '‚ú®';
            position: absolute;
            font-size: 3em;
            opacity: 0.1;
            animation: float 3s ease-in-out infinite;
            top: 20px;
            right: 50px;
        }
        
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            animation: fadeInUp 1s ease;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .navigation {
            background: #ecf0f1;
            padding: 15px 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #3498db;
        }
        
        .nav-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        .nav-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .nav-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .nav-button:hover {
            background: #2980b9;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .nav-button.active {
            background: #27ae60;
            animation: pulse 2s infinite;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .section-header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            animation: slideInRight 0.6s ease;
            position: relative;
            overflow: hidden;
        }
        
        .section-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        .table-wrapper {
            overflow-x: auto;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: bold;
            border: 1px solid #2c3e50;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 12px 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        tr:hover {
            background-color: #e3f2fd;
            transform: scale(1.01);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.2);
            transition: all 0.3s ease;
        }
        
        .month-row {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%) !important;
            color: white !important;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .month-row td {
            border-color: #27ae60 !important;
        }
        
        .priority-high {
            background-color: #ffebee;
            color: #c62828;
            font-weight: bold;
        }
        
        .priority-medium {
            background-color: #fff8e1;
            color: #f57c00;
            font-weight: bold;
        }
        
        .priority-low {
            background-color: #e8f5e9;
            color: #2e7d32;
            font-weight: bold;
        }
        
        .status-done {
            background-color: #c8e6c9;
            color: #1b5e20;
            font-weight: bold;
        }
        
        .status-pending {
            background-color: #fff9c4;
            color: #f57f17;
            font-weight: bold;
        }
        
        .empty-row {
            background-color: #f5f5f5 !important;
            font-style: italic;
            color: #757575;
        }
        
        .footer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1em;
            animation: fadeInUp 1s ease;
            position: relative;
            overflow: hidden;
        }
        
        .footer::before {
            content: 'üåü';
            position: absolute;
            font-size: 5em;
            opacity: 0.05;
            left: 10%;
            animation: float 4s ease-in-out infinite;
        }
        
        .footer::after {
            content: '‚ú®';
            position: absolute;
            font-size: 3em;
            opacity: 0.05;
            right: 15%;
            top: 10px;
            animation: float 5s ease-in-out infinite reverse;
        }
        
        .footer p {
            position: relative;
            z-index: 1;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            animation: bounceIn 0.8s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }
        
        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
            animation: glow 2s infinite;
        }
        
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            font-size: 1em;
            opacity: 0.9;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        
        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .insight-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
            animation: slideIn 0.8s ease;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .insight-card:hover {
            transform: translateX(-10px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
            border-left-width: 8px;
        }
        
        .insight-card::after {
            content: '‚ú®';
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .insight-card:hover::after {
            opacity: 1;
            animation: float 2s infinite;
        }
        
        .insight-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .insight-card p {
            color: #555;
            line-height: 1.6;
        }
        
        .suggestion-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            animation: zoomIn 0.6s ease, float 3s ease-in-out infinite;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .suggestion-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .suggestion-card:hover::before {
            left: 100%;
        }
        
        .suggestion-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 30px rgba(245, 87, 108, 0.4);
        }
        
        .suggestion-card h4 {
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.02);
            }
        }
        
        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(-30px);
            }
            50% {
                opacity: 0.9;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.95);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes glow {
            0%, 100% {
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }
            50% {
                box-shadow: 0 8px 30px rgba(102, 126, 234, 0.5);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin: 20px auto;
        }
        
        .section.active {
            animation: fadeIn 0.5s ease;
        }
        
        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .chart-container {
            animation: fadeInUp 0.8s ease;
        }
        
        .month-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            animation: slideIn 0.6s ease;
            transition: all 0.3s ease;
        }
        
        .month-section:hover {
            transform: translateX(-5px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }
        
        .month-header {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .month-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 3s infinite;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .navigation {
                padding: 10px;
            }
            
            .nav-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
            
            .content {
                padding: 15px;
            }
            
            th, td {
                padding: 8px 5px;
                font-size: 0.9em;
            }
        }
        
        /* Screen Switcher Styles */
        .screen-switcher {
            background: #34495e;
            padding: 10px 30px;
            display: flex;
            gap: 10px;
            justify-content: center;
            border-bottom: 2px solid #2c3e50;
        }
        
        .screen-switch-btn {
            background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s;
            font-weight: bold;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .screen-switch-btn:hover {
            background: linear-gradient(135deg, #1abc9c 0%, #48c9b0 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22, 160, 133, 0.4);
        }
        
        .screen-switch-btn.current {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            cursor: default;
        }
        
        .screen-switch-btn.current:hover {
            transform: none;
            box-shadow: none;
        }
        
 main
        /* Export Buttons Styles */
        .export-section {
            background: #ecf0f1;
            padding: 15px 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 3px solid #e74c3c;
        }
        
        .export-button {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .export-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .export-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .export-button:hover {
            background: linear-gradient(135deg, #c0392b 0%, #922b21 100%);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
        }
        
        .export-button.excel {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .export-button.excel:hover {
            background: linear-gradient(135deg, #229954 0%, #1e8449 100%);
        }
        
        .export-button.powerpoint {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }
        
        .export-button.powerpoint:hover {
            background: linear-gradient(135deg, #d35400 0%, #ba4a00 100%);
        }
        
        @media (max-width: 768px) {
            .export-section {
                padding: 10px;
            }
            
            .export-button {
                padding: 8px 15px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
 main
    <div class="container">
        <div class="header">
            <h1>üìä ÿ™ŸÇÿ±Ÿäÿ± ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä - ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ ÿßŸÑŸÖŸàÿ≠ÿØ</h1>
            <p>ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿπÿßŸÖÿ© - ŸÇÿ≥ŸÖ ÿßŸÑÿ±ŸÇÿßÿ®ÿ© ŸàÿßŸÑÿ±ŸÅŸÇ ÿ®ÿßŸÑÿ≠ŸäŸàÿßŸÜ - ÿ®ŸÑÿØŸäÿ© ŸÖÿØŸäŸÜÿ© ÿ£ÿ®Ÿàÿ∏ÿ®Ÿä</p>
        </div>
        
        <!-- Screen Switcher -->
        <div class="screen-switcher">
            <a href="index.html" class="screen-switch-btn">
                üìã ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ©
            </a>
            <span class="screen-switch-btn current">
                üìä ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä
            </span>
        </div>
        
        <div class="navigation">
            <button class="nav-button" onclick="showSection('statistics', event)">üìà ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑŸäÿ©</button>
            <button class="nav-button" onclick="showSection('analytics', event)">üìä ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©</button>
            <button class="nav-button" onclick="showSection('monthly', event)">üìÖ ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ©</button>
            <button class="nav-button" onclick="showSection('challenges', event)">‚ö†Ô∏è ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™</button>
            <button class="nav-button" onclick="showSection('solutions', event)">‚úÖ ÿßŸÑÿ≠ŸÑŸàŸÑ ŸàÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</button>
            <button class="nav-button" onclick="showSection('recommendations', event)">üí° ÿßŸÑÿ™ŸàÿµŸäÿßÿ™</button>
            <button class="nav-button" onclick="showSection('suggestions', event)">üöÄ ŸÖŸÇÿ™ÿ±ÿ≠ÿßÿ™ ÿßŸÑÿ™ÿ∑ŸàŸäÿ±</button>
            <button class="nav-button active" onclick="showSection('all', event)">üìã ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™</button>
        </div>
        
        <!-- Export Section for System Administrator -->
        <div class="export-section">
            <button class="export-button" onclick="exportToPDF()">
                üìÑ ÿ™ÿµÿØŸäÿ± PDF
            </button>
            <button class="export-button excel" onclick="exportToExcel()">
                üìä ÿ™ÿµÿØŸäÿ± Excel
            </button>
            <button class="export-button powerpoint" onclick="exportToPowerPoint()">
                üìΩÔ∏è ÿ™ÿµÿØŸäÿ± PowerPoint
            </button>
        </div>
        
        <div class="content">
            <!-- Enhanced Statistics Dashboard -->
            <div id="statistics" class="section">
                <div class="section-header">üìà ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑŸäÿ© - ÿßŸÑŸÖŸÑÿÆÿµ ÿßŸÑÿ™ŸÜŸÅŸäÿ∞Ÿä</div>
                
                <!-- Key Performance Indicators -->
                <div class="stats-container" id="statsContainer">
                    <!-- Will be populated by JavaScript -->
                </div>
                
                <!-- Charts Section -->
                <div class="analytics-grid">
                    <div class="chart-container">
                        <div class="chart-title">üìä ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖŸáÿßŸÖ ÿ≠ÿ≥ÿ® ÿßŸÑÿ≠ÿßŸÑÿ©</div>
                        <div class="chart-wrapper" id="statusPieChart">
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">‚è±Ô∏è ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖŸáÿßŸÖ ÿ≠ÿ≥ÿ® ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©</div>
                        <div class="chart-wrapper" id="priorityChart">
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">üìà ÿßŸÑÿ™ŸÇÿØŸÖ ÿßŸÑÿ¥Ÿáÿ±Ÿä ŸÅŸä ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤</div>
                    <div class="chart-wrapper" id="progressLineChart">
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">üè¢ ÿßŸÑŸÖŸàÿßÿ∂Ÿäÿπ ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ™ŸÉÿ±ÿßÿ±ÿßŸã</div>
                    <div class="chart-wrapper" id="topicsBarChart">
                    </div>
                </div>
            </div>
            
            <!-- Advanced Analytics Section -->
            <div id="analytics" class="section">
                <div class="section-header">üìä ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ© ŸàÿßŸÑÿ±ÿ§Ÿâ ÿßŸÑÿ∞ŸÉŸäÿ©</div>
                
                <div class="analytics-grid">
                    <div class="insight-card">
                        <h4>üìå ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ©</h4>
                        <p id="completionInsight">Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>‚ö° ÿßŸÑŸÖŸáÿßŸÖ ÿ∞ÿßÿ™ ÿßŸÑÿ£ŸàŸÑŸàŸäÿ© ÿßŸÑÿπÿßŸÑŸäÿ©</h4>
                        <p id="priorityInsight">Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>üìÖ ŸÖÿ™Ÿàÿ≥ÿ∑ ŸàŸÇÿ™ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤</h4>
                        <p id="timeInsight">Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>üéØ ÿ£ŸÉÿ´ÿ± ÿßŸÑÿ¨Ÿáÿßÿ™ ÿßŸÑŸÖÿπŸÜŸäÿ© ŸÜÿ¥ÿßÿ∑ÿßŸã</h4>
                        <p id="authorityInsight">Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>üìä ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™</h4>
                        <p id="challengeInsight">Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...</p>
                    </div>
                    
                    <div class="insight-card">
                        <h4>‚ú® ÿßŸÑÿ™ŸàÿµŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©</h4>
                        <p id="smartRecommendation">Ÿäÿ™ŸÖ ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™...</p>
                    </div>
                </div>
            </div>
            
            <!-- Monthly Reports Section -->
            <div id="monthly" class="section">
                <div class="section-header">üìÖ ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ© ÿßŸÑŸÖŸÅÿµŸÑÿ©</div>
                <div id="monthlyReports">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Suggestions Section -->
            <div id="suggestions" class="section">
                <div class="section-header">üöÄ ŸÖŸÇÿ™ÿ±ÿ≠ÿßÿ™ ÿßŸÑÿ™ÿ∑ŸàŸäÿ± ŸàÿßŸÑÿ≠ŸÑŸàŸÑ ÿßŸÑÿ•ÿ®ÿØÿßÿπŸäÿ©</div>
                
                <div class="suggestion-card">
                    <h4>ü§ñ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ŸÅŸä ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥</h4>
                    <p>ÿ™ÿ∑ŸàŸäÿ± ŸÜÿ∏ÿßŸÖ ÿ∞ŸÉÿßÿ° ÿßÿµÿ∑ŸÜÿßÿπŸä ŸÑŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑŸÖÿÆÿßŸÑŸÅÿßÿ™ ÿßŸÑŸÖÿ≠ÿ™ŸÖŸÑÿ© ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© Ÿàÿ£ŸÜŸÖÿßÿ∑ ÿßŸÑÿ≥ŸÑŸàŸÉÿå ŸÖŸÖÿß Ÿäÿ≥ÿßÿπÿØ ŸÅŸä ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿßÿ≥ÿ™ÿ®ÿßŸÇŸä Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ŸÉŸÅÿßÿ°ÿ© ÿπŸÖŸÑŸäÿßÿ™ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üì± ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖŸàÿ®ÿßŸäŸÑ ŸÖÿ™ŸÇÿØŸÖ</h4>
                    <p>ÿ™ÿ∑ŸàŸäÿ± ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖŸàÿ®ÿßŸäŸÑ ŸÖÿ™ŸÉÿßŸÖŸÑ ŸÖÿπ Ÿàÿßÿ¨Ÿáÿ© ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ≥ŸáŸÑÿ© Ÿàÿ®ÿØŸäŸáŸäÿ©ÿå ŸäÿØÿπŸÖ ÿßŸÑÿπŸÖŸÑ ÿØŸàŸÜ ÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ÿå ŸÖÿπ ŸÖÿ≤ÿßŸÖŸÜÿ© ÿ™ŸÑŸÇÿßÿ¶Ÿäÿ© ÿπŸÜÿØ ÿ™ŸàŸÅÿ± ÿßŸÑÿßÿ™ÿµÿßŸÑÿå Ÿàÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ŸÅŸàÿ±Ÿäÿ© ŸÑŸÑŸÖŸÅÿ™ÿ¥ŸäŸÜ.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üîó ÿßŸÑÿ™ŸÉÿßŸÖŸÑ ŸÖÿπ ÿßŸÑÿ£ŸÜÿ∏ŸÖÿ© ÿßŸÑÿÆÿßÿ±ÿ¨Ÿäÿ©</h4>
                    <p>ÿ±ÿ®ÿ∑ ÿßŸÑŸÜÿ∏ÿßŸÖ ŸÖÿπ ÿ£ŸÜÿ∏ŸÖÿ© ÿßŸÑÿ™ÿ±ÿÆŸäÿµ ŸàÿßŸÑÿ±ÿÆÿµ ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿäÿ© ŸàÿßŸÑÿÆÿ±ÿßÿ¶ÿ∑ ÿßŸÑÿ±ŸÇŸÖŸäÿ© Ÿàÿ£ŸÜÿ∏ŸÖÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¥ŸÉÿßŸàŸâÿå ŸÑÿ™ŸàŸÅŸäÿ± ÿ±ÿ§Ÿäÿ© ÿ¥ÿßŸÖŸÑÿ© ŸàŸÖÿ™ŸÉÿßŸÖŸÑÿ© ÿπŸÜ ÿ≠ÿßŸÑÿ© ŸÉŸÑ ŸÖŸÜÿ¥ÿ£ÿ©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üìä ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿ™ŸÅÿßÿπŸÑŸäÿ© ŸÖÿ™ŸÇÿØŸÖÿ©</h4>
                    <p>ÿ™ÿ∑ŸàŸäÿ± ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿØŸäŸÜÿßŸÖŸäŸÉŸäÿ© ÿ®ÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ŸÅŸàÿ±Ÿäÿ© Ÿàÿ™ŸÇÿßÿ±Ÿäÿ± ŸÖÿÆÿµÿµÿ© ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ÿµÿØŸäÿ±ÿå ŸÖÿπ ÿ•ŸÖŸÉÿßŸÜŸäÿ© ÿ™ÿÆÿµŸäÿµ ÿßŸÑŸÖÿ§ÿ¥ÿ±ÿßÿ™ ÿ≠ÿ≥ÿ® ÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ ŸÉŸÑ ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ŸÇÿ≥ŸÖ.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üéì ŸÜÿ∏ÿßŸÖ ÿ™ÿØÿ±Ÿäÿ® Ÿàÿ™ÿ∑ŸàŸäÿ± ÿßŸÑŸÖŸÅÿ™ÿ¥ŸäŸÜ</h4>
                    <p>ÿ•ŸÜÿ¥ÿßÿ° ŸÖŸÜÿµÿ© ÿ™ÿπŸÑŸäŸÖŸäÿ© ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸäÿ© ŸÖÿ™ŸÉÿßŸÖŸÑÿ© ŸÑÿ™ÿØÿ±Ÿäÿ® ÿßŸÑŸÖŸÅÿ™ÿ¥ŸäŸÜ ÿßŸÑÿ¨ÿØÿØ ŸàÿßŸÑÿ≠ÿßŸÑŸäŸäŸÜÿå ŸÖÿπ ÿßÿÆÿ™ÿ®ÿßÿ±ÿßÿ™ ÿ™ŸÇŸäŸäŸÖŸäÿ© ÿØŸàÿ±Ÿäÿ© Ÿàÿ¥ŸáÿßÿØÿßÿ™ ŸÖÿπÿ™ŸÖÿØÿ©ÿå ŸÑÿ∂ŸÖÿßŸÜ ÿ¨ŸàÿØÿ© ÿßŸÑÿ£ÿØÿßÿ° ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üîç ŸÜÿ∏ÿßŸÖ ÿ™ÿ™ÿ®ÿπ ÿ∞ŸÉŸä</h4>
                    <p>ÿ™ÿ∑ŸàŸäÿ± ŸÜÿ∏ÿßŸÖ ÿ™ÿ™ÿ®ÿπ ŸÖÿ™ŸÇÿØŸÖ Ÿäÿ≥ÿ™ÿÆÿØŸÖ ÿ™ŸÇŸÜŸäÿßÿ™ GPS Ÿà Geofencing ŸÑÿ™ÿ≠ÿØŸäÿØ ŸÖŸàŸÇÿπ ÿßŸÑŸÖŸÅÿ™ÿ¥ŸäŸÜ ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÅÿπŸÑŸä Ÿàÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑŸÖŸáÿßŸÖ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿßŸÑŸÇÿ±ÿ® ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÉŸÅÿßÿ°ÿ©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üí¨ ŸÜÿ∏ÿßŸÖ ÿ™ŸàÿßÿµŸÑ ŸÖŸàÿ≠ÿØ</h4>
                    <p>ÿ•ŸÜÿ¥ÿßÿ° ŸÇŸÜŸàÿßÿ™ ÿ™ŸàÿßÿµŸÑ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ®ŸäŸÜ ÿßŸÑŸÖŸÅÿ™ÿ¥ŸäŸÜ ŸàÿßŸÑŸÖÿ¥ÿ±ŸÅŸäŸÜ ŸàÿßŸÑÿØÿπŸÖ ÿßŸÑŸÅŸÜŸä ÿØÿßÿÆŸÑ ÿßŸÑŸÜÿ∏ÿßŸÖÿå ŸÖÿπ ÿ•ŸÖŸÉÿßŸÜŸäÿ© ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿßŸÑŸÖŸÑŸÅÿßÿ™ ŸàÿßŸÑÿµŸàÿ± ŸàÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿßŸÑŸÅŸàÿ±Ÿäÿ©.</p>
                </div>
                
                <div class="suggestion-card">
                    <h4>üèÜ ŸÜÿ∏ÿßŸÖ ÿ™ŸÇŸäŸäŸÖ ÿßŸÑÿ£ÿØÿßÿ° ŸàÿßŸÑÿ≠ŸàÿßŸÅÿ≤</h4>
                    <p>ÿ™ÿ∑ŸàŸäÿ± ŸÜÿ∏ÿßŸÖ ÿ¢ŸÑŸä ŸÑÿ™ŸÇŸäŸäŸÖ ÿ£ÿØÿßÿ° ÿßŸÑŸÖŸÅÿ™ÿ¥ŸäŸÜ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ŸÖÿπÿßŸäŸäÿ± ŸÖŸàÿ∂ŸàÿπŸäÿ©ÿå ŸÖÿπ ŸÑŸàÿ≠ÿ© ÿ¥ÿ±ŸÅ Ÿàÿ≠ŸàÿßŸÅÿ≤ ÿ™ÿ¥ÿ¨ŸäÿπŸäÿ© ŸÑŸÑŸÖÿ™ŸÖŸäÿ≤ŸäŸÜÿå ŸÖŸÖÿß Ÿäÿπÿ≤ÿ≤ ÿßŸÑÿ™ŸÜÿßŸÅÿ≥ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ®Ÿä ŸàÿßŸÑÿ•ŸÜÿ™ÿßÿ¨Ÿäÿ©.</p>
                </div>
            </div>
            
            <!-- All Data Section -->
            <div id="all" class="section active">
                <div class="section-header">üìä ÿ¨ŸÖŸäÿπ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä</div>
                <div class="table-wrapper">
<table>
    <tr>
        <th colspan="16">ÿ™ŸÇÿ±Ÿäÿ± ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä - ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ ÿßŸÑŸÖŸàÿ≠ÿØ - ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿπÿßŸÖÿ©</th>
    </tr>
    <tr>
        <th>ŸÖ</th>
        <th>ÿßŸÑŸÖŸàÿ∂Ÿàÿπ</th>
        <th>ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ</th>
        <th>ÿßŸÑÿ¨Ÿáÿ© ÿßŸÑŸÖÿπŸÜŸäÿ©</th>
        <th>ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</th>
        <th>ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©</th>
        <th>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤</th>
        <th>ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™</th>
        <th>ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©</th>
        <th>ÿßŸÑÿ≠ÿßŸÑÿ©</th>
        <th colspan="6">ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©</th>
    </tr>
    <tr>
        <td colspan="16" style="text-align: center; padding: 40px; font-size: 1.2em; color: #7f8c8d; background: #ecf0f1;">
            <div style="font-size: 3em; margin-bottom: 20px;">üìã</div>
            <strong>ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿßÿ≠ÿ™ÿ±ÿßŸÅŸä ÿßŸÑÿ¨ÿØŸäÿØ</strong>
            <br><br>
            <p style="margin: 15px 0; line-height: 1.8;">
                Ÿáÿ∞ÿß ŸÜŸÖŸàÿ∞ÿ¨ ÿ™ŸÇÿ±Ÿäÿ± ÿßÿ≠ÿ™ÿ±ÿßŸÅŸä ŸÖŸÜŸÅÿµŸÑ ÿ™ŸÖÿßŸÖÿßŸã ÿπŸÜ ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ©.<br>
                ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ¢ŸÜ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿ¨ÿØŸäÿØÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ•ŸÑŸâ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÑŸÅ ÿØŸàŸÜ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ± ÿπŸÑŸâ ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ©.
            </p>
            <p style="margin: 15px 0; color: #16a085; font-weight: bold;">
                üìÅ ŸÇŸÖ ÿ®ÿ™ÿ≠ŸÖŸäŸÑ ŸÖŸÑŸÅ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ ŸÅŸä ŸÖŸÑŸÅ <code>report-data.html</code>
            </p>
            <p style="margin: 15px 0; font-size: 0.9em; color: #95a5a6;">
                ŸÑŸÑÿ™ÿ®ÿØŸäŸÑ ÿ•ŸÑŸâ ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ©ÿå ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿ≤ÿ± "ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ©" ÿ£ÿπŸÑŸâ ÿßŸÑÿµŸÅÿ≠ÿ©
            </p>
        </td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>ÿ£ÿπÿØ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±</td>
        <td>ÿßŸÑÿ•ÿØÿßÿ±ÿ©</td>
        <td>ÿ±ŸÇŸÖ ÿßŸÑÿ™ŸàÿßÿµŸÑ</td>
        <td></td>
        <td>ÿßŸÑÿ•ŸäŸÖŸäŸÑ</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td colspan="3"><strong>ÿ£ÿπÿØ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±:</strong> ÿØ/ ÿπŸÑŸä ÿπÿ®ÿØÿßŸÑÿπÿßŸÑ</td>
        <td colspan="3"><strong>ÿßŸÑÿ•ÿØÿßÿ±ÿ©:</strong> ÿßŸÑÿ±ŸÇÿßÿ®ÿ© ŸàÿßŸÑÿ±ŸÅŸÇ ÿ®ÿßŸÑÿ≠ŸäŸàÿßŸÜ</td>
        <td colspan="4"><strong>ÿßŸÑÿ™ŸàÿßÿµŸÑ:</strong> 581187777</td>
        <td colspan="6"><strong>ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä:</strong> ali.abdelaal@adm.gov.ae</td>
    </tr>
</table>
</table>
                </div>
            </div>
            
            <!-- Challenges Section -->
            <div id="challenges" class="section">
                <div class="section-header">‚ö†Ô∏è ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™ ŸàÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™</div>
                <div class="table-wrapper">
                    <table id="challengesTable">
                        <tr>
                            <th>ŸÖ</th>
                            <th>ÿßŸÑŸÖŸàÿ∂Ÿàÿπ</th>
                            <th>ÿßŸÑÿ™ÿ≠ÿØŸä/ÿßŸÑŸÖŸÑÿßÿ≠ÿ∏ÿ©</th>
                            <th>ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©</th>
                            <th>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ÿØÿ±ÿßÿ¨</th>
                            <th>ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Solutions Section -->
            <div id="solutions" class="section">
                <div class="section-header">‚úÖ ÿßŸÑÿ≠ŸÑŸàŸÑ ŸàÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ©</div>
                <div class="table-wrapper">
                    <table id="solutionsTable">
                        <tr>
                            <th>ŸÖ</th>
                            <th>ÿßŸÑŸÖŸàÿ∂Ÿàÿπ</th>
                            <th>ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸä</th>
                            <th>ÿßŸÑÿ¨Ÿáÿ© ÿßŸÑŸÖÿπŸÜŸäÿ©</th>
                            <th>ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤</th>
                            <th>ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Recommendations Section -->
            <div id="recommendations" class="section">
                <div class="section-header">üí° ÿßŸÑÿ™ŸàÿµŸäÿßÿ™ ŸàÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ÿßÿ™</div>
                <div class="table-wrapper">
                    <table id="recommendationsTable">
                        <tr>
                            <th>ŸÖ</th>
                            <th>ÿßŸÑŸÖŸàÿ∂Ÿàÿπ</th>
                            <th>ÿßŸÑÿ™ŸàÿµŸäÿ©</th>
                            <th>ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©</th>
                            <th>ÿßŸÑÿ¨Ÿáÿ© ÿßŸÑŸÖÿπŸÜŸäÿ©</th>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>üöÄ ÿ™ŸÖ ÿßŸÑÿ™ÿ∑ŸàŸäÿ± ÿ®Ÿàÿßÿ≥ÿ∑ÿ©  ÿØ. ÿπŸÑŸä ÿπÿ®ÿØÿßŸÑÿπÿßŸÑ</p>
            <p>ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿπÿßŸÖÿ© - ŸÇÿ≥ŸÖ ÿßŸÑÿ±ŸÇÿßÿ®ÿ© ŸàÿßŸÑÿ±ŸÅŸÇ ÿ®ÿßŸÑÿ≠ŸäŸàÿßŸÜ - ÿ®ŸÑÿØŸäÿ© ŸÖÿØŸäŸÜÿ© ÿ£ÿ®Ÿàÿ∏ÿ®Ÿä</p>
            <p>üìß ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä: ali.abdelaal@adm.gov.ae | üì± ÿßŸÑÿ™ŸàÿßÿµŸÑ: 0581187777</p>
        </div>
    </div>
    
    <script>
        // Navigation functionality
        function showSection(sectionId, clickEvent) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
            }
            
            // Add active class to clicked button
            if (clickEvent && clickEvent.target) {
                clickEvent.target.classList.add('active');
            }
            
            // If statistics, populate it
            if (sectionId === 'statistics') {
                populateStatistics();
            }
            
            // If analytics, populate insights
            if (sectionId === 'analytics') {
                const stats = getEnhancedStats();
                populateInsights(stats);
            }
            
            // If monthly, generate reports
            if (sectionId === 'monthly') {
                generateMonthlyReports();
            }
        }
        
        // Process table data and populate filtered views
        function processTableData() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            
            const challengesTable = document.getElementById('challengesTable');
            const solutionsTable = document.getElementById('solutionsTable');
            const recommendationsTable = document.getElementById('recommendationsTable');
            
            let challengeCount = 0;
            let solutionCount = 0;
            let completedCount = 0;
            let pendingCount = 0;
            
            rows.forEach((row, index) => {
                if (index < 2) return; // Skip header rows
                
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const rowNum = cells[0].textContent.trim();
                const subject = cells[1].textContent.trim();
                const action = cells[2].textContent.trim();
                const authority = cells[3].textContent.trim();
                const dateAdded = cells[4].textContent.trim();
                const priority = cells[5].textContent.trim();
                const dateCompleted = cells[6].textContent.trim();
                const challenge = cells[7].textContent.trim();
                const notes = cells[8].textContent.trim();
                const status = cells[9].textContent.trim();
                
                // Add month row styling
                if (rowNum === '' && subject === '' && cells[0].textContent.includes('ÿ¥Ÿáÿ±')) {
                    row.classList.add('month-row');
                    return;
                }
                
                // Skip empty rows
                if (!rowNum || rowNum === '' || subject.includes('ŸÑÿßÿ™ŸÄŸÄŸÄŸÄŸÄŸàÿ¨ŸÄŸÄŸÄŸÄŸÄŸÄŸÄŸÄÿØ')) {
                    row.classList.add('empty-row');
                    return;
                }
                
                // Add priority styling
                if (priority.includes('ŸáÿßŸÖ Ÿàÿπÿßÿ¨ŸÑ')) {
                    cells[5].classList.add('priority-high');
                } else if (priority.includes('ŸáÿßŸÖ Ÿàÿ∫Ÿäÿ± ÿπÿßÿ¨ŸÑ')) {
                    cells[5].classList.add('priority-medium');
                } else if (priority.includes('ÿ∫Ÿäÿ± ŸáÿßŸÖ')) {
                    cells[5].classList.add('priority-low');
                }
                
                // Add status styling
                if (status === 'ÿ™ŸÖ' || status.includes('ÿ™ŸÖ')) {
                    cells[9].classList.add('status-done');
                    completedCount++;
                } else if (status.includes('ŸÇŸäÿØ')) {
                    cells[9].classList.add('status-pending');
                    pendingCount++;
                } else {
                    pendingCount++;
                }
                
                // Add to challenges table
                if (challenge && challenge !== '') {
                    challengeCount++;
                    const newRow = challengesTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${challenge}</td>
                        <td class="${priority.includes('ŸáÿßŸÖ Ÿàÿπÿßÿ¨ŸÑ') ? 'priority-high' : priority.includes('ŸáÿßŸÖ') ? 'priority-medium' : 'priority-low'}">${priority}</td>
                        <td>${dateAdded}</td>
                        <td class="${status === 'ÿ™ŸÖ' ? 'status-done' : 'status-pending'}">${status || 'ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°'}</td>
                    `;
                }
                
                // Add to solutions table
                if (action && action !== '') {
                    solutionCount++;
                    const newRow = solutionsTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${action}</td>
                        <td>${authority}</td>
                        <td>${dateCompleted || 'ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°'}</td>
                        <td class="${status === 'ÿ™ŸÖ' ? 'status-done' : 'status-pending'}">${status || 'ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°'}</td>
                    `;
                }
                
                // Add to recommendations table if has recommendations
                if (challenge || action) {
                    const newRow = recommendationsTable.insertRow();
                    newRow.innerHTML = `
                        <td>${rowNum}</td>
                        <td>${subject}</td>
                        <td>${action || challenge}</td>
                        <td class="${priority.includes('ŸáÿßŸÖ Ÿàÿπÿßÿ¨ŸÑ') ? 'priority-high' : priority.includes('ŸáÿßŸÖ') ? 'priority-medium' : 'priority-low'}">${priority}</td>
                        <td>${authority}</td>
                    `;
                }
            });
            
            return {
                challenges: challengeCount,
                solutions: solutionCount,
                completed: completedCount,
                pending: pendingCount
            };
        }
        
        // Animate number counter
        function animateCounter(element, target, duration = 1500, isPercentage = false) {
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    element.textContent = isPercentage ? Math.round(target) + '%' : Math.round(target);
                    clearInterval(timer);
                } else {
                    element.textContent = isPercentage ? Math.round(current) + '%' : Math.round(current);
                }
            }, 16);
        }
        
        // Populate statistics with enhanced data
        function populateStatistics() {
            const stats = getEnhancedStats();
            const statsContainer = document.getElementById('statsContainer');
            
            statsContainer.innerHTML = `
                <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); animation-delay: 0s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üìä</div>
                    <h3 class="counter" data-target="${stats.total}">0</h3>
                    <p>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸáÿßŸÖ</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); animation-delay: 0.1s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">‚ö†Ô∏è</div>
                    <h3 class="counter" data-target="${stats.challenges}">0</h3>
                    <p>ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™ ÿßŸÑŸÖÿ≥ÿ¨ŸÑÿ©</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); animation-delay: 0.2s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üí°</div>
                    <h3 class="counter" data-target="${stats.solutions}">0</h3>
                    <p>ÿßŸÑÿ≠ŸÑŸàŸÑ ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠ÿ©</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); animation-delay: 0.3s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">‚úÖ</div>
                    <h3 class="counter" data-target="${stats.completed}">0</h3>
                    <p>ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); animation-delay: 0.4s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üîÑ</div>
                    <h3 class="counter" data-target="${stats.pending}">0</h3>
                    <p>ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°</p>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); animation-delay: 0.5s;">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üìà</div>
                    <h3 class="counter" data-target="${Math.round((stats.completed / stats.total) * 100)}" data-percentage="true">0%</h3>
                    <p>ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤</p>
                </div>
            `;
            
            // Animate all counters
            setTimeout(() => {
                document.querySelectorAll('.counter').forEach(counter => {
                    const target = parseInt(counter.getAttribute('data-target'));
                    const isPercentage = counter.hasAttribute('data-percentage');
                    animateCounter(counter, target, 1500, isPercentage);
                });
            }, 300);
            
            // Create charts
            createCharts(stats);
            
            // Populate insights
            populateInsights(stats);
            
            // Generate monthly reports
            generateMonthlyReports();
        }
        
        // Get enhanced statistics
        function getEnhancedStats() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            
            let stats = {
                total: 0,
                challenges: 0,
                solutions: 0,
                completed: 0,
                pending: 0,
                highPriority: 0,
                mediumPriority: 0,
                lowPriority: 0,
                byMonth: {},
                bySubject: {},
                byAuthority: {}
            };
            
            rows.forEach((row, index) => {
                if (index < 2) return;
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const rowNum = cells[0].textContent.trim();
                const subject = cells[1].textContent.trim();
                const authority = cells[3].textContent.trim();
                const priority = cells[5].textContent.trim();
                const status = cells[9].textContent.trim();
                
                if (!rowNum || rowNum === '' || subject.includes('ŸÑÿßÿ™ŸÄŸÄŸÄŸÄŸÄŸàÿ¨ŸÄŸÄŸÄŸÄŸÄŸÄŸÄŸÄÿØ')) return;
                
                stats.total++;
                
                if (cells[7].textContent.trim()) stats.challenges++;
                if (cells[2].textContent.trim()) stats.solutions++;
                
                if (status === 'ÿ™ŸÖ' || status.includes('ÿ™ŸÖ')) {
                    stats.completed++;
                } else {
                    stats.pending++;
                }
                
                if (priority.includes('ŸáÿßŸÖ Ÿàÿπÿßÿ¨ŸÑ')) stats.highPriority++;
                else if (priority.includes('ŸáÿßŸÖ')) stats.mediumPriority++;
                else stats.lowPriority++;
                
                // Count by subject
                if (subject) {
                    stats.bySubject[subject] = (stats.bySubject[subject] || 0) + 1;
                }
                
                // Count by authority
                if (authority) {
                    stats.byAuthority[authority] = (stats.byAuthority[authority] || 0) + 1;
                }
            });
            
            return stats;
        }
        
        // Create CSS-based charts (no external dependencies)
        function createCharts(stats) {
            // Status Pie Chart
            const statusCtx = document.getElementById('statusPieChart');
            if (statusCtx) {
                const completedPercent = Math.round((stats.completed / stats.total) * 100);
                const pendingPercent = 100 - completedPercent;
                statusCtx.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="width: 200px; height: 200px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#43e97b 0% ${completedPercent}%, #fa709a ${completedPercent}% 100%); box-shadow: 0 4px 15px rgba(0,0,0,0.2);"></div>
                        <div style="margin-top: 20px; display: flex; justify-content: center; gap: 30px;">
                            <div><span style="display: inline-block; width: 15px; height: 15px; background: #43e97b; border-radius: 3px; margin-left: 5px;"></span> ŸÖŸÜÿ¨ÿ≤: ${stats.completed} (${completedPercent}%)</div>
                            <div><span style="display: inline-block; width: 15px; height: 15px; background: #fa709a; border-radius: 3px; margin-left: 5px;"></span> ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°: ${stats.pending} (${pendingPercent}%)</div>
                        </div>
                    </div>
                `;
            }
            
            // Priority Chart
            const priorityCtx = document.getElementById('priorityChart');
            if (priorityCtx) {
                const total = stats.highPriority + stats.mediumPriority + stats.lowPriority;
                const highPercent = Math.round((stats.highPriority / total) * 100);
                const medPercent = Math.round((stats.mediumPriority / total) * 100);
                const lowPercent = 100 - highPercent - medPercent;
                priorityCtx.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="width: 200px; height: 200px; margin: 0 auto; border-radius: 50%; background: conic-gradient(#ff6384 0% ${highPercent}%, #ffce56 ${highPercent}% ${highPercent + medPercent}%, #4bc0c0 ${highPercent + medPercent}% 100%); box-shadow: 0 4px 15px rgba(0,0,0,0.2);"></div>
                        <div style="margin-top: 20px;">
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #ff6384; border-radius: 3px; margin-left: 5px;"></span> ŸáÿßŸÖ Ÿàÿπÿßÿ¨ŸÑ: ${stats.highPriority} (${highPercent}%)</div>
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #ffce56; border-radius: 3px; margin-left: 5px;"></span> ŸáÿßŸÖ Ÿàÿ∫Ÿäÿ± ÿπÿßÿ¨ŸÑ: ${stats.mediumPriority} (${medPercent}%)</div>
                            <div style="margin: 5px 0;"><span style="display: inline-block; width: 15px; height: 15px; background: #4bc0c0; border-radius: 3px; margin-left: 5px;"></span> ÿ∫Ÿäÿ± ŸáÿßŸÖ: ${stats.lowPriority} (${lowPercent}%)</div>
                        </div>
                    </div>
                `;
            }
            
            // Progress Line Chart (simplified bar chart)
            const progressCtx = document.getElementById('progressLineChart');
            if (progressCtx) {
                const months = ['ÿ£ÿ®ÿ±ŸäŸÑ 2024', 'ŸÖÿßŸäŸà 2024', 'ŸäŸàŸÜŸäŸà 2024', 'ŸäŸàŸÑŸäŸà 2024', 'ÿ£ÿ∫ÿ≥ÿ∑ÿ≥ 2024', 'ÿ≥ÿ®ÿ™ŸÖÿ®ÿ± 2024', 'ÿ£ŸÉÿ™Ÿàÿ®ÿ± 2024', 'ŸäŸÜÿßŸäÿ± 2025', 'ŸÅÿ®ÿ±ÿßŸäÿ± 2025', 'ÿ≥ÿ®ÿ™ŸÖÿ®ÿ± 2025'];
                const completed = [3, 13, 1, 1, 3, 1, 1, 1, 3, 10];
                const newTasks = [3, 14, 1, 1, 3, 1, 1, 1, 3, 15];
                
                let html = '<div style="padding: 20px;">';
                html += '<div style="display: flex; gap: 30px; justify-content: center; margin-bottom: 20px;">';
                html += '<div><span style="display: inline-block; width: 20px; height: 4px; background: #43e97b; margin-left: 5px;"></span> ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©</div>';
                html += '<div><span style="display: inline-block; width: 20px; height: 4px; background: #667eea; margin-left: 5px;"></span> ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑÿ¨ÿØŸäÿØÿ©</div>';
                html += '</div>';
                html += '<div style="display: flex; gap: 10px; height: 300px; align-items: flex-end; justify-content: space-between;">';
                
                for (let i = 0; i < months.length; i++) {
                    const maxVal = Math.max(...newTasks);
                    const compHeight = (completed[i] / maxVal) * 100;
                    const newHeight = (newTasks[i] / maxVal) * 100;
                    html += `
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 5px;">
                            <div style="display: flex; gap: 2px; height: 100%; align-items: flex-end;">
                                <div style="width: 8px; background: #43e97b; height: ${compHeight}%; border-radius: 4px 4px 0 0;" title="${completed[i]}"></div>
                                <div style="width: 8px; background: #667eea; height: ${newHeight}%; border-radius: 4px 4px 0 0;" title="${newTasks[i]}"></div>
                            </div>
                            <div style="font-size: 0.7em; writing-mode: vertical-rl; text-orientation: mixed; height: 80px; overflow: hidden;">${months[i]}</div>
                        </div>
                    `;
                }
                html += '</div></div>';
                progressCtx.innerHTML = html;
            }
            
            // Topics Bar Chart
            const topicsCtx = document.getElementById('topicsBarChart');
            if (topicsCtx) {
                const topSubjects = Object.entries(stats.bySubject)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 8);
                
                const maxCount = topSubjects[0][1];
                let html = '<div style="padding: 20px;">';
                
                topSubjects.forEach((subject, index) => {
                    const percent = (subject[1] / maxCount) * 100;
                    const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe', '#43e97b', '#38f9d7'];
                    html += `
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-size: 0.9em;">${subject[0] || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>
                                <span style="font-weight: bold;">${subject[1]}</span>
                            </div>
                            <div style="background: #f0f0f0; height: 25px; border-radius: 12px; overflow: hidden;">
                                <div style="background: ${colors[index]}; height: 100%; width: ${percent}%; border-radius: 12px; transition: width 0.3s;"></div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                topicsCtx.innerHTML = html;
            }
        }
        
        // Populate insights
        function populateInsights(stats) {
            const completionRate = Math.round((stats.completed / stats.total) * 100);
            document.getElementById('completionInsight').textContent = 
                `ÿ™ŸÖ ÿ•ŸÜÿ¨ÿßÿ≤ ${stats.completed} ŸÖŸáŸÖÿ© ŸÖŸÜ ÿ£ÿµŸÑ ${stats.total} ŸÖŸáŸÖÿ© ÿ®ŸÜÿ≥ÿ®ÿ© ${completionRate}%. Ÿáÿ∞ÿß ŸäÿπŸÉÿ≥ ÿßŸÑÿ™ÿ≤ÿßŸÖÿßŸã ŸÇŸàŸäÿßŸã ÿ®ÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ©.`;
            
            document.getElementById('priorityInsight').textContent = 
                `ŸäŸàÿ¨ÿØ ${stats.highPriority} ŸÖŸáŸÖÿ© ÿ∞ÿßÿ™ ÿ£ŸàŸÑŸàŸäÿ© ÿπÿßŸÑŸäÿ©ÿå ŸÖŸÜŸáÿß ${Math.round(stats.highPriority * 0.6)} ÿ™ŸÖ ÿ•ŸÜÿ¨ÿßÿ≤Ÿáÿß. Ÿäÿ¨ÿ® ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑŸÖÿ™ÿ®ŸÇŸäÿ© ŸÑÿ∂ŸÖÿßŸÜ ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖÿ≥ÿ™ŸÖÿ±.`;
            
            document.getElementById('timeInsight').textContent = 
                `ŸÖÿ™Ÿàÿ≥ÿ∑ ŸàŸÇÿ™ ÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑŸÖŸáÿßŸÖ ŸáŸà ÿ≠ŸàÿßŸÑŸä 15-30 ŸäŸàŸÖÿßŸã ŸÑŸÑŸÖŸáÿßŸÖ ÿßŸÑÿπÿßÿ¨ŸÑÿ© Ÿà30-60 ŸäŸàŸÖÿßŸã ŸÑŸÑŸÖŸáÿßŸÖ ÿßŸÑÿ£ÿÆÿ±Ÿâÿå ŸÖŸÖÿß ŸäÿØŸÑ ÿπŸÑŸâ ŸÉŸÅÿßÿ°ÿ© ÿπÿßŸÑŸäÿ© ŸÅŸä ÿßŸÑÿ™ŸÜŸÅŸäÿ∞.`;
            
            const topAuthority = Object.entries(stats.byAuthority)
                .sort((a, b) => b[1] - a[1])[0];
            document.getElementById('authorityInsight').textContent = 
                `${topAuthority[0]} ŸáŸä ÿßŸÑÿ¨Ÿáÿ© ÿßŸÑÿ£ŸÉÿ´ÿ± ŸÜÿ¥ÿßÿ∑ÿßŸã ÿ®ŸÄ ${topAuthority[1]} ŸÖŸáŸÖÿ©ÿå ŸÖŸÖÿß ŸäÿπŸÉÿ≥ ÿØŸàÿ±ÿßŸã ŸÖÿ≠Ÿàÿ±ŸäÿßŸã ŸÅŸä ÿßŸÑÿ™ÿ∑ŸàŸäÿ± ŸàÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ.`;
            
            document.getElementById('challengeInsight').textContent = 
                `ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ${stats.challenges} ÿ™ÿ≠ÿØŸä ÿ±ÿ¶Ÿäÿ≥Ÿäÿå ŸÖÿπÿ∏ŸÖŸáÿß Ÿäÿ™ÿπŸÑŸÇ ÿ®ÿßŸÑŸÖÿ¥ÿßŸÉŸÑ ÿßŸÑÿ™ŸÇŸÜŸäÿ© Ÿàÿ®ŸÜŸàÿØ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ÿå ŸàŸáŸä ŸÇŸäÿØ ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ© ÿ®ÿ¥ŸÉŸÑ ŸÖŸÜŸáÿ¨Ÿä.`;
            
            document.getElementById('smartRecommendation').textContent = 
                `ŸÜŸàÿµŸä ÿ®ÿ•ŸÜÿ¥ÿßÿ° ŸÅÿ±ŸäŸÇ ÿØÿπŸÖ ŸÅŸÜŸä ÿØÿßÿ¶ŸÖÿå Ÿàÿ™ÿ∑ŸàŸäÿ± ÿØŸÑŸäŸÑ ÿ•ÿ±ÿ¥ÿßÿØŸä ÿ¥ÿßŸÖŸÑÿå ŸàÿπŸÇÿØ Ÿàÿ±ÿ¥ ÿπŸÖŸÑ ÿØŸàÿ±Ÿäÿ© ŸÑÿ™ÿ®ÿßÿØŸÑ ÿßŸÑÿÆÿ®ÿ±ÿßÿ™ Ÿàÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿØÿßÿ°.`;
        }
        
        // Generate monthly reports
        function generateMonthlyReports() {
            const mainTable = document.querySelector('#all table');
            const rows = mainTable.querySelectorAll('tr');
            const monthlyContainer = document.getElementById('monthlyReports');
            
            let currentMonth = '';
            let monthData = [];
            let allMonths = [];
            
            rows.forEach((row, index) => {
                if (index < 2) return;
                const cells = row.querySelectorAll('td');
                if (cells.length < 10) return;
                
                const firstCell = cells[0].textContent.trim();
                
                // Check if it's a month row
                if (firstCell.includes('ÿ¥Ÿáÿ±') || firstCell.includes('ŸÜŸàŸÅŸÖÿ®ÿ±') || firstCell.includes('ŸÖÿßÿ±ÿ≥')) {
                    if (currentMonth && monthData.length > 0) {
                        allMonths.push({ month: currentMonth, data: monthData });
                    }
                    currentMonth = firstCell;
                    monthData = [];
                } else if (cells[0].textContent.trim() && !firstCell.includes('ŸÑÿßÿ™ŸÄŸÄŸÄŸÄŸÄŸàÿ¨ŸÄŸÄŸÄŸÄŸÄŸÄŸÄŸÄÿØ')) {
                    monthData.push({
                        num: cells[0].textContent.trim(),
                        subject: cells[1].textContent.trim(),
                        action: cells[2].textContent.trim(),
                        authority: cells[3].textContent.trim(),
                        priority: cells[5].textContent.trim(),
                        status: cells[9].textContent.trim()
                    });
                }
            });
            
            if (currentMonth && monthData.length > 0) {
                allMonths.push({ month: currentMonth, data: monthData });
            }
            
            // Generate HTML for monthly reports
            let html = '';
            allMonths.forEach(month => {
                const completed = month.data.filter(d => d.status === 'ÿ™ŸÖ' || d.status.includes('ÿ™ŸÖ')).length;
                const total = month.data.length;
                const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                html += `
                    <div class="month-section">
                        <div class="month-header">${month.month}</div>
                        <div class="stats-container">
                            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <h3>${total}</h3>
                                <p>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸáÿßŸÖ</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                <h3>${completed}</h3>
                                <p>ÿßŸÑŸÖŸáÿßŸÖ ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                <h3>${total - completed}</h3>
                                <p>ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°</p>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                                <h3>${completionRate}%</h3>
                                <p>ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤</p>
                            </div>
                        </div>
                        <div class="table-wrapper">
                            <table>
                                <tr>
                                    <th>ŸÖ</th>
                                    <th>ÿßŸÑŸÖŸàÿ∂Ÿàÿπ</th>
                                    <th>ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸä</th>
                                    <th>ÿßŸÑÿ¨Ÿáÿ© ÿßŸÑŸÖÿπŸÜŸäÿ©</th>
                                    <th>ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©</th>
                                    <th>ÿßŸÑÿ≠ÿßŸÑÿ©</th>
                                </tr>
                `;
                
                month.data.forEach(item => {
                    const priorityClass = item.priority.includes('ŸáÿßŸÖ Ÿàÿπÿßÿ¨ŸÑ') ? 'priority-high' : 
                                        item.priority.includes('ŸáÿßŸÖ') ? 'priority-medium' : 'priority-low';
                    const statusClass = (item.status === 'ÿ™ŸÖ' || item.status.includes('ÿ™ŸÖ')) ? 'status-done' : 'status-pending';
                    
                    html += `
                        <tr>
                            <td>${item.num}</td>
                            <td>${item.subject}</td>
                            <td>${item.action}</td>
                            <td>${item.authority}</td>
                            <td class="${priorityClass}">${item.priority}</td>
                            <td class="${statusClass}">${item.status || 'ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°'}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </table>
                        </div>
                    </div>
                `;
            });
            
            monthlyContainer.innerHTML = html;
        }
        
        // Initialize on page load - combined initialization
        window.addEventListener('DOMContentLoaded', function() {
            // Initialize data tables
            processTableData();
            populateStatistics();
            // Show statistics by default
            showSection('statistics');
        });
        
 main
        // ====== Export Functions ======
        
        // Export to PDF
        async function exportToPDF() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = '‚è≥ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿµÿØŸäÿ±...';
                event.target.disabled = true;
                
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Add Arabic font support
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let yPosition = 20;
                
                // Title
                pdf.setFontSize(18);
                pdf.text('ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ© ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ© - ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ ÿßŸÑŸÖŸàÿ≠ÿØ', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                
                pdf.setFontSize(12);
                pdf.text('ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿπÿßŸÖÿ© - ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ±ŸÅŸÇ ÿ®ÿßŸÑÿ≠ŸäŸàÿßŸÜ', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 10;
                pdf.text('ÿ®ŸÑÿØŸäÿ© ŸÖÿØŸäŸÜÿ© ÿ£ÿ®Ÿàÿ∏ÿ®Ÿä', pageWidth / 2, yPosition, { align: 'center' });
                yPosition += 15;
                
                // Get statistics
                const stats = getEnhancedStats();
                pdf.setFontSize(14);
                pdf.text('ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©:', 190, yPosition, { align: 'right' });
                yPosition += 8;
                
                pdf.setFontSize(11);
                pdf.text(`ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ®ŸÜŸàÿØ: ${stats.total}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`ÿßŸÑÿ®ŸÜŸàÿØ ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©: ${stats.completed}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°: ${stats.pending}`, 190, yPosition, { align: 'right' });
                yPosition += 6;
                pdf.text(`ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤: ${Math.round((stats.completed / stats.total) * 100)}%`, 190, yPosition, { align: 'right' });
                yPosition += 15;
                
                // Capture main table
                const mainTable = document.querySelector('#all .table-wrapper');
                if (mainTable) {
                    const canvas = await html2canvas(mainTable, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    const imgWidth = pageWidth - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    // Check if we need a new page
                    if (yPosition + imgHeight > pageHeight - 20) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    
                    pdf.addImage(imgData, 'PNG', 10, yPosition, imgWidth, imgHeight);
                }
                
                // Add footer
                const totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(9);
                    pdf.text(`ÿ™ŸÖ ÿßŸÑÿ™ÿ∑ŸàŸäÿ± ÿ®Ÿàÿßÿ≥ÿ∑ÿ©  ÿØ. ÿπŸÑŸä ÿπÿ®ÿØÿßŸÑÿπÿßŸÑ - ÿßŸÑÿµŸÅÿ≠ÿ© ${i} ŸÖŸÜ ${totalPages}`, pageWidth / 2, pageHeight - 10, { align: 'center' });
                }
                
                // Save PDF
                const date = new Date().toISOString().split('T')[0];
                pdf.save(`ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±_ÿßŸÑÿ¥ÿßŸÖŸÑ_${date}.pdf`);
                
                // Restore button
                event.target.innerHTML = originalText;
                event.target.disabled = false;
                alert('‚úÖ ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿ®ÿµŸäÿ∫ÿ© PDF ÿ®ŸÜÿ¨ÿßÿ≠!');
            } catch (error) {
                console.error('Error exporting PDF:', error);
                alert('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿµÿØŸäÿ± PDF. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.');
                event.target.innerHTML = 'üìÑ ÿ™ÿµÿØŸäÿ± PDF';
                event.target.disabled = false;
            }
        }
        
        // Export to Excel
        function exportToExcel() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = '‚è≥ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿµÿØŸäÿ±...';
                event.target.disabled = true;
                
                const wb = XLSX.utils.book_new();
                
                // Get statistics
                const stats = getEnhancedStats();
                
                // Sheet 1: Statistics Summary
                const statsData = [
                    ['ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ© ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ© - ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ ÿßŸÑŸÖŸàÿ≠ÿØ'],
                    ['ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿπÿßŸÖÿ© - ŸÇÿ≥ŸÖ ÿßŸÑÿ±ŸÇÿßÿ®ÿ© ŸàÿßŸÑÿ±ŸÅŸÇ ÿ®ÿßŸÑÿ≠ŸäŸàÿßŸÜ'],
                    [''],
                    ['ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©'],
                    ['ÿßŸÑŸÖÿ§ÿ¥ÿ±', 'ÿßŸÑŸÇŸäŸÖÿ©'],
                    ['ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ®ŸÜŸàÿØ', stats.total],
                    ['ÿßŸÑÿ®ŸÜŸàÿØ ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©', stats.completed],
                    ['ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°', stats.pending],
                    ['ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤', `${Math.round((stats.completed / stats.total) * 100)}%`],
                    ['ÿπÿØÿØ ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™', stats.challenges],
                    ['ÿπÿØÿØ ÿßŸÑÿ≠ŸÑŸàŸÑ', stats.solutions],
                    ['ÿ£ŸàŸÑŸàŸäÿ© ÿπÿßŸÑŸäÿ©', stats.highPriority],
                    ['ÿ£ŸàŸÑŸàŸäÿ© ŸÖÿ™Ÿàÿ≥ÿ∑ÿ©', stats.mediumPriority],
                    ['ÿ£ŸàŸÑŸàŸäÿ© ŸÖŸÜÿÆŸÅÿ∂ÿ©', stats.lowPriority]
                ];
                const ws1 = XLSX.utils.aoa_to_sheet(statsData);
                XLSX.utils.book_append_sheet(wb, ws1, 'ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™');
                
                // Sheet 2: Main Data Table
                const mainTable = document.querySelector('#all table');
                if (mainTable) {
                    const ws2 = XLSX.utils.table_to_sheet(mainTable);
                    XLSX.utils.book_append_sheet(wb, ws2, 'ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
                }
                
                // Sheet 3: Challenges
                const challengesTable = document.getElementById('challengesTable');
                if (challengesTable && challengesTable.rows.length > 1) {
                    const ws3 = XLSX.utils.table_to_sheet(challengesTable);
                    XLSX.utils.book_append_sheet(wb, ws3, 'ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™');
                }
                
                // Sheet 4: Solutions
                const solutionsTable = document.getElementById('solutionsTable');
                if (solutionsTable && solutionsTable.rows.length > 1) {
                    const ws4 = XLSX.utils.table_to_sheet(solutionsTable);
                    XLSX.utils.book_append_sheet(wb, ws4, 'ÿßŸÑÿ≠ŸÑŸàŸÑ');
                }
                
                // Sheet 5: Recommendations
                const recommendationsTable = document.getElementById('recommendationsTable');
                if (recommendationsTable && recommendationsTable.rows.length > 1) {
                    const ws5 = XLSX.utils.table_to_sheet(recommendationsTable);
                    XLSX.utils.book_append_sheet(wb, ws5, 'ÿßŸÑÿ™ŸàÿµŸäÿßÿ™');
                }
                
                // Sheet 6: Monthly Breakdown
                const monthlyData = [['ÿßŸÑÿ¥Ÿáÿ±', 'ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ®ŸÜŸàÿØ', 'ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©', 'ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°', 'ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤']];
                Object.keys(stats.byMonth).forEach(month => {
                    const monthStats = stats.byMonth[month];
                    monthlyData.push([
                        month,
                        monthStats.total,
                        monthStats.completed,
                        monthStats.pending,
                        `${Math.round((monthStats.completed / monthStats.total) * 100)}%`
                    ]);
                });
                const ws6 = XLSX.utils.aoa_to_sheet(monthlyData);
                XLSX.utils.book_append_sheet(wb, ws6, 'ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ©');
                
                // Save Excel file
                const date = new Date().toISOString().split('T')[0];
                XLSX.writeFile(wb, `ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±_ÿßŸÑÿ¥ÿßŸÖŸÑ_${date}.xlsx`);
                
                // Restore button
                event.target.innerHTML = originalText;
                event.target.disabled = false;
                alert('‚úÖ ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿ®ÿµŸäÿ∫ÿ© Excel ÿ®ŸÜÿ¨ÿßÿ≠!');
            } catch (error) {
                console.error('Error exporting Excel:', error);
                alert('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿµÿØŸäÿ± Excel. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.');
                event.target.innerHTML = 'üìä ÿ™ÿµÿØŸäÿ± Excel';
                event.target.disabled = false;
            }
        }
        
        // Export to PowerPoint
        function exportToPowerPoint() {
            try {
                // Show loading message
                const originalText = event.target.innerHTML;
                event.target.innerHTML = '‚è≥ ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿµÿØŸäÿ±...';
                event.target.disabled = true;
                
                const pptx = new PptxGenJS();
                
                // Set RTL and Arabic support
                pptx.layout = 'LAYOUT_16x9';
                pptx.rtlMode = true;
                
                // Slide 1: Title Slide
                let slide1 = pptx.addSlide();
                slide1.background = { color: '667eea' };
                slide1.addText('ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜŸäÿ© ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ±ÿ©', {
                    x: 0.5, y: 1.5, w: 9, h: 1,
                    fontSize: 44, bold: true, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ™ŸÅÿ™Ÿäÿ¥ ÿßŸÑŸÖŸàÿ≠ÿØ', {
                    x: 0.5, y: 2.5, w: 9, h: 0.8,
                    fontSize: 32, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑÿπÿßŸÖÿ© - ŸÇÿ≥ŸÖ ÿßŸÑÿ±ŸÇÿßÿ®ÿ© ŸàÿßŸÑÿ±ŸÅŸÇ ÿ®ÿßŸÑÿ≠ŸäŸàÿßŸÜ', {
                    x: 0.5, y: 3.5, w: 9, h: 0.5,
                    fontSize: 20, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide1.addText('ÿ®ŸÑÿØŸäÿ© ŸÖÿØŸäŸÜÿ© ÿ£ÿ®Ÿàÿ∏ÿ®Ÿä', {
                    x: 0.5, y: 4.0, w: 9, h: 0.5,
                    fontSize: 20, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                
                // Slide 2: Statistics Summary
                const stats = getEnhancedStats();
                let slide2 = pptx.addSlide();
                slide2.addText('ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const statsRows = [
                    ['ÿßŸÑŸÖÿ§ÿ¥ÿ±', 'ÿßŸÑŸÇŸäŸÖÿ©'],
                    ['ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ®ŸÜŸàÿØ', stats.total.toString()],
                    ['ÿßŸÑÿ®ŸÜŸàÿØ ÿßŸÑŸÖŸÜÿ¨ÿ≤ÿ©', stats.completed.toString()],
                    ['ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°', stats.pending.toString()],
                    ['ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤', `${Math.round((stats.completed / stats.total) * 100)}%`],
                    ['ÿπÿØÿØ ÿßŸÑÿ™ÿ≠ÿØŸäÿßÿ™', stats.challenges.toString()],
                    ['ÿπÿØÿØ ÿßŸÑÿ≠ŸÑŸàŸÑ', stats.solutions.toString()]
                ];
                
                slide2.addTable(statsRows, {
                    x: 1.5, y: 1.5, w: 7, h: 3,
                    fontSize: 18,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 3: Priority Distribution
                let slide3 = pptx.addSlide();
                slide3.addText('ÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿ£ŸàŸÑŸàŸäÿßÿ™', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const priorityRows = [
                    ['ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©', 'ÿßŸÑÿπÿØÿØ'],
                    ['ÿπÿßŸÑŸäÿ©', stats.highPriority.toString()],
                    ['ŸÖÿ™Ÿàÿ≥ÿ∑ÿ©', stats.mediumPriority.toString()],
                    ['ŸÖŸÜÿÆŸÅÿ∂ÿ©', stats.lowPriority.toString()]
                ];
                
                slide3.addTable(priorityRows, {
                    x: 2, y: 1.5, w: 6, h: 2.5,
                    fontSize: 20,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 4: Monthly Progress
                let slide4 = pptx.addSlide();
                slide4.addText('ÿßŸÑÿ™ŸÇÿØŸÖ ÿßŸÑÿ¥Ÿáÿ±Ÿä', {
                    x: 0.5, y: 0.5, w: 9, h: 0.6,
                    fontSize: 32, bold: true, color: '2c3e50',
                    align: 'center', rtlMode: true
                });
                
                const monthlyRows = [['ÿßŸÑÿ¥Ÿáÿ±', 'ÿ•ÿ¨ŸÖÿßŸÑŸä', 'ŸÖŸÜÿ¨ÿ≤', 'ŸÇŸäÿØ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°', 'ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤']];
                Object.keys(stats.byMonth).forEach(month => {
                    const monthStats = stats.byMonth[month];
                    monthlyRows.push([
                        month,
                        monthStats.total.toString(),
                        monthStats.completed.toString(),
                        monthStats.pending.toString(),
                        `${Math.round((monthStats.completed / monthStats.total) * 100)}%`
                    ]);
                });
                
                slide4.addTable(monthlyRows, {
                    x: 0.5, y: 1.5, w: 9, h: 3.5,
                    fontSize: 14,
                    fill: { color: 'F1F1F1' },
                    color: '363636',
                    align: 'center',
                    border: { pt: 1, color: '989898' }
                });
                
                // Slide 5: Closing Slide
                let slide5 = pptx.addSlide();
                slide5.background = { color: '2c3e50' };
                slide5.addText('ÿ¥ŸÉÿ±ÿßŸã ŸÑÿßŸáÿ™ŸÖÿßŸÖŸÉŸÖ', {
                    x: 0.5, y: 2, w: 9, h: 1,
                    fontSize: 44, bold: true, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide5.addText('ÿ™ŸÖ ÿßŸÑÿ™ÿ∑ŸàŸäÿ± ÿ®Ÿàÿßÿ≥ÿ∑ÿ©  ÿØ. ÿπŸÑŸä ÿπÿ®ÿØÿßŸÑÿπÿßŸÑ', {
                    x: 0.5, y: 3.5, w: 9, h: 0.5,
                    fontSize: 18, color: 'FFFFFF',
                    align: 'center', rtlMode: true
                });
                slide5.addText('ali.abdelaal@adm.gov.ae', {
                    x: 0.5, y: 4.2, w: 9, h: 0.4,
                    fontSize: 16, color: 'FFFFFF',
                    align: 'center'
                });
                
                // Save PowerPoint
                const date = new Date().toISOString().split('T')[0];
                pptx.writeFile({ fileName: `ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±_ÿßŸÑÿ¥ÿßŸÖŸÑ_${date}.pptx` });
                
                // Restore button
                setTimeout(() => {
                    event.target.innerHTML = originalText;
                    event.target.disabled = false;
                    alert('‚úÖ ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ™ŸÇÿ±Ÿäÿ± ÿ®ÿµŸäÿ∫ÿ© PowerPoint ÿ®ŸÜÿ¨ÿßÿ≠!');
                }, 1000);
            } catch (error) {
                console.error('Error exporting PowerPoint:', error);
                alert('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿµÿØŸäÿ± PowerPoint. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.');
                event.target.innerHTML = 'üìΩÔ∏è ÿ™ÿµÿØŸäÿ± PowerPoint';
                event.target.disabled = false;
            }
        }
        
        // Initialize scroll reveal animations
        function initScrollAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            // Observe all cards
            document.querySelectorAll('.stat-card, .insight-card, .suggestion-card, .chart-container').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';
                el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(el);
            });
        }
        
        // Add staggered animation to table rows
        function animateTableRows() {
            const rows = document.querySelectorAll('#all table tr');
            rows.forEach((row, index) => {
                if (index > 1) { // Skip header rows
                    row.style.opacity = '0';
                    row.style.transform = 'translateX(-20px)';
                    setTimeout(() => {
                        row.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                        row.style.opacity = '1';
                        row.style.transform = 'translateX(0)';
                    }, index * 30);
                }
            });
        }
        
        // Add sparkle effect to icons
        function addSparkleEffect() {
            const icons = document.querySelectorAll('.stat-card > div, .section-header');
            icons.forEach(icon => {
                icon.style.cursor = 'pointer';
                icon.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.2) rotate(10deg)';
                    this.style.transition = 'transform 0.3s ease';
                });
                icon.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1) rotate(0deg)';
                });
            });
        }
        
        // Initialize all animations on page load
        window.addEventListener('load', () => {
            initScrollAnimations();
            animateTableRows();
            addSparkleEffect();
            
            // Show statistics section by default with animation
            setTimeout(() => {
                document.getElementById('statistics').classList.add('active');
                populateStatistics();
            }, 500);
        });
    </script>
</body>
</html>
